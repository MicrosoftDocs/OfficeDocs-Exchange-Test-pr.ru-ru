---
title: Устранение неполадок в наборе средств проверки работоспособности службы RPS.Proxy
TOCTitle: Устранение неполадок в наборе средств проверки работоспособности службы RPS.Proxy
ms:assetid: a5058323-5d86-438a-ad4a-fa4292310e98
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/ms.exch.scom.rps.proxy(v=EXCHG.150)
ms:contentKeyID: 53275664
ms.date: 11/14/2015
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Устранение неполадок в наборе средств проверки работоспособности службы RPS.Proxy

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2015-03-09_

Набор для контроля работоспособности службы RPS.Proxy отслеживает состояние общей работоспособности службы Remote PowerShell.

Получение предупреждения о неработоспособности службы RPS.Proxy указывает на проблему, которая может препятствовать использованию службы Remote PowerShell для доступа к Exchange.

## Пояснение

Работа службы RPS отслеживается с помощью перечисленных ниже зондов и мониторов.


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Зонд</th>
<th>Настройки работоспособности</th>
<th>Зависимости</th>
<th>Связанные мониторы</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>RPSProxyTestProbe</p></td>
<td><p>Служба RPS.Proxy</p></td>
<td><p>Active Directory</p></td>
<td><p>RPSProxyTestMonitor</p></td>
</tr>
</tbody>
</table>


Дополнительные сведения о зондах и мониторах см. в разделе [Работоспособность и производительность сервера](https://technet.microsoft.com/ru-ru/library/jj150551\(v=exchg.150\)).

## Распространенные проблемы

Существует несколько возможных причин отказа зонда. Ниже приведены некоторые из наиболее распространенных проблем:

  - Пул приложений, расположенный на отслеживаемом сервере CAS, работает неправильно.

  - Введены неправильные данные учетной записи наблюдения.

  - Контроллеры доменов не отвечают.

## Действия пользователя

Возможно, что после отправки предупреждения служба возобновила свою работу. Таким образом, при получении предупреждения о неисправности настройки работоспособности сначала следует проверить наличие проблемы. Если проблема не устранена, выполните необходимые действия по восстановлению, описание которых приводится в следующих разделах.

## Проверка наличия проблемы

1.  Определите имена настроек работоспособности и сервера, указанные в оповещении.

2.  В сообщении указана информация о том, что именно привело к появлению предупреждения. В большинстве случаев сообщение содержит достаточный объем диагностической информации для определения основной причины. Если в сообщении приводятся непонятные сведения:
    
    1.  Запустите командную консоль Exchange и выполните следующую команду, чтобы получить сведения о наборе для контроля работоспособности, от которого получено предупреждение:
        
            Get-ServerHealth <server name> | ?{$_.HealthSetName -eq "<health set name>"}
        
        Например, для получения сведений о наборе контроля работоспособности RPS.Proxy на server1.contoso.com, выполните следующую команду:
        
            Get-ServerHealth server1.contoso.com | ?{$_.HealthSetName -eq "RPS.Proxy"}
    
    2.  Ознакомьтесь с выходным потоком команды, чтобы определить монитор, который сообщил об ошибке. Значение параметра **AlertValue** для монитора, который создал предупреждение будет равно `Unhealthy`.
    
    3.  Перезапустите связанный зонд для монитора, который находится в неработоспособном состоянии. Обратитесь к таблице в разделе Пояснение, чтобы найти связанный зонд. Для этого выполните следующую команду:
        
            Invoke-MonitoringProbe <health set name>\<probe name> -Server <server name> | Format-List
        
        Допустим, что отказал монитор **RPSProxyTestMonitor**. С этим монитором связан зонд **RPSProxyTestProbe**. Для запуска этого зонда на server1.contoso.com выполните следующую команду:
        
            Invoke-MonitoringProbe RPS.Proxy\RPSProxyTestProbe -Server server1.contoso.com | Format-List
    
    4.  В выходном потоке команды проверьте значение параметра зонда **Результат**. Если это значение равно **Выполнено успешно**, то проблема была связана с временной ошибкой и теперь отсутствует. В противном случае воспользуйтесь инструкцией по восстановлению, приведенной в следующих разделах.

## Действия по восстановлению RPSProxyTestMonitor

Предупреждение от набора для контроля работоспособности содержит указанные ниже сведения.

  - Имя сервера CAS, который отправил предупреждение.

  - Полная трассировка исключения, включая сообщения об ошибке, диагностические данные и конкретные данные заголовка HTTP. Сведения полной трассировки исключения можно использовать для устранения неполадки.

  - Время и дата возникновения проблемы.

Для устранения неполадки выполните указанные ниже действия.

1.  Просмотрите журналы протоколов на серверах клиентского доступа. Журналы протоколов расположены в папке *\<каталог установки exchange server\>*\\Logging\\HttpProxy*\\\<протокол\>* на сервере CAS.

2.  Создайте тестовую учетную запись пользователя, а затем с ее помощью войдите на сервер CAS, например на https:// *\<имя\_сервера\>*/owa

3.  Запустите диспетчер IIS, подключитесь к серверу, который сообщил о проблеме, и убедитесь, что пул приложений MSExchangePowerShellFrontEndAppPool запущен на сервере CAS.

4.  Выберите пункт **Пулы приложений**, а затем повторно запустите пул приложений **MSExchangeRpcProxyAppPool**, выполнив следующую команду из командной консоли Exchange:
    
        %SystemRoot%\System32\inetsrv\Appcmd recycle MSExchangePowerShellFrontEndAppPool

5.  Перезапустите связанный зонд, как показано в действии 2.c. в разделе Проверка наличия проблемы.

6.  Если проблему не удалось устранить, перезапустите службу IIS с помощью служебной программы IISReset.

7.  Перезапустите связанный зонд, как показано в действии 2.c. в разделе Проверка наличия проблемы.

8.  Если проблема не устранена, перезапустите сервер.

9.  После перезагрузки сервера перезапустите связанный зонд, как показано в действии 2.c. в разделе Проверка наличия проблемы.

10. Если сбои зонда происходят постоянно, то для решения этой проблемы может понадобиться помощь. Для решения этой проблемы обратитесь к специалисту службы технической поддержки Майкрософт. Сделать это можно в [Центре решений Exchange Server](http://go.microsoft.com/fwlink/p/?linkid=180809). В области навигации выберите элемент **Варианты поддержки и ресурсы** и выберите один из вариантов в разделе **Получите техническую поддержку**, чтобы обратиться к соответствующему специалисту. Так прямое обращение в службу технической поддержки Майкрософт в вашей организации может регламентироваться, сначала ознакомьтесь с инструкциями организации.

## Дополнительные сведения

[Новые возможности в Exchange 2013](https://technet.microsoft.com/ru-ru/library/jj150540\(v=exchg.150\))

[Командлеты Exchange 2013](https://technet.microsoft.com/ru-ru/library/bb124413\(v=exchg.150\))

