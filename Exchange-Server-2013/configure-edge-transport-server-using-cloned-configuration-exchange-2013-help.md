---
title: 'Настройка пограничного транспортного сервера с помощью клонированной конфигурации: Exchange 2013 Help'
TOCTitle: Настройка пограничного транспортного сервера с помощью клонированной конфигурации
ms:assetid: 0bbc83e3-e5e8-4480-a8a6-15f035360856
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Aa996008(v=EXCHG.150)
ms:contentKeyID: 61183370
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Настройка пограничного транспортного сервера с помощью клонированной конфигурации

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2015-04-13_

Вы можете использовать имеющиеся в командной консоли Exchange сценарии (расположенные в папке %ExchangeInstallPath%Scripts), чтобы дублировать конфигурацию пограничного транспортного сервера. Этот процесс называется *клонированием конфигурации*. *Клонирование конфигурации* — это способ развертывания новых пограничных транспортных серверов на основе данных конфигурации ранее настроенного исходного сервера. Данные конфигурации ранее настроенного исходного сервера копируются и экспортируются в файл XML, который затем импортируется на целевой сервер. Обзор данного процесса см. в разделе [Клонированная конфигурация пограничного транспортного сервера](edge-transport-server-cloned-configuration-exchange-2013-help.md).

Сведения о конфигурации пограничного транспортного сервера хранятся в службах Active Directory облегченного доступа к каталогам (AD LDS) и не реплицируются между несколькими пограничными транспортными серверами. Клонирование конфигурации гарантирует, что все пограничные транспортные серверы, развернутые в сети периметра, используют одну конфигурацию.

Для выполнения задач клонирования конфигурации используются два приведенных ниже сценария командной консоли.

  - **ExportEdgeConfig.ps1** Экспорт всех настраиваемых пользователем параметров и данных с пограничного транспортного сервера и сохранение этих данных в XML-файле.

  - **ImportEdgeConfig.ps1** На этапе проверки конфигурации сценарий ImportEdgeConfig.ps1 проверяет XML-файл на правильность серверных параметров экспорта для целевого сервера. Если настройки необходимо изменить, сценарий записывает недопустимые значения в файл ответов, где администратор указывает данные целевого сервера, которые будут использоваться на этапе импорта конфигурации. На этапе импорта конфигурации сценарий импортирует все настроенные пользователем параметры и данные, которые сохранены в промежуточном XML-файле, созданном сценарием ExportEdgeConfig.ps1.

По умолчанию оба сценария расположены в папке %ExchangeInstallPath%Scripts.

## Приступая к работе

  - Предполагаемое время выполнения задачи: 30 минут.

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись "Пограничные транспортные серверы" в разделе [Разрешения потока обработки почты](mail-flow-permissions-exchange-2013-help.md).

  - В клонированную конфигурацию не копируются параметры пограничной подписки сервера. Сертификаты EdgeSync не клонируются. Процесс EdgeSync необходимо запустить независимо для каждого пограничного транспортного сервера. EdgeSync перезаписывает параметры, включенные как в данные клонированной конфигурации, так и в данные репликации EdgeSync.

  - Если какие-либо соединители отправки настроены на использование учетных данных, пароль записывается в промежуточном файле XML в виде зашифрованной строки. Со сценариями ImportEdgeConfig.ps1 и ExportEdgeConfig.ps1 можно использовать параметр *-key*, чтобы задать 32-байтовую строку для шифрования и дешифрования пароля. Если параметр *-key* не используется, используется ключ шифрования по умолчанию.

  - Для выполнения этой процедуры можно использовать только командную консоль.Сведения о том, как открыть командную консоль Exchange в локальной организации Exchange, см. в статье [Открытие командной консоли Exchange](https://technet.microsoft.com/ru-ru/library/dd638134\(v=exchg.150\)).

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

<table>
<thead>
<tr class="header">
<th><img src="images/Bb124558.tip(EXCHG.150).gif" title="Совет" alt="Совет" />Совет.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>.</td>
</tr>
</tbody>
</table>


## Как это сделать?

## Действие 1. Экспорт данных конфигурации исходного сервера в файл на исходном сервере

1.  Скопируйте сценарий ExportEdgeConfig.ps1 в корневую папку своего профиля пользователя на исходном сервере.

2.  Чтобы экспортировать данные конфигурации исходного сервера в файл на исходном сервере, используйте приведенный ниже синтаксис.
    
        ./ExportEdgeConfig.ps1 -CloneConfigData:"<configuration file>"
    
    Например, чтобы экспортировать данные конфигурации исходного сервера в файл C:\\CloneConfigData.xml, выполните приведенную ниже команду.
    
        ./ExportEdgeConfig.ps1 -CloneConfigData:"C:\CloneConfigData.xml"

## Как проверить, что шаг выполнен?

Вы успешно экспортировали данные конфигурации исходного сервера в файл, если отобразится подтверждение "Данные пограничной конфигурации успешно экспортированы в: \<путь к выходному файлу\>".

## Действие 2. Проверка файла конфигурации и создание файла ответов на целевом сервере

1.  Скопируйте файл конфигурации исходного сервера, экспортированный в предыдущем шаге, на целевой пограничный транспортный сервер.

2.  Скопируйте сценарий ImportEdgeConfig.ps1 в корневую папку своего профиля пользователя на целевом сервере.

3.  Чтобы проверить файл конфигурации и использовать результаты для создания файла ответов на целевом сервере, используйте приведенный ниже синтаксис.
    
        ./ImportEdgeConfig.ps1 -CloneConfigData:"<configuration file>" -IsImport $false -CloneConfigAnswer:"<answer file>"
    
    Например, чтобы проверить файл конфигурации C:\\CloneConfigData.xml и создать файл ответов C:\\CloneConfigAnswer.xml, выполните приведенную ниже команду.
    
        ./ImportEdgeConfig.ps1 -CloneConfigData:"C:\CloneConfigData.xml" -IsImport $false -CloneConfigAnswer:"C:\CloneConfigAnswer.xml"

4.  Откройте файл ответов и измените любые параметры, недопустимые для целевого сервера. Если изменения не требуются, файл ответов будет пустым. Сохраните сделанные изменения.

## Как проверить, что шаг выполнен?

Вы успешно проверили файл конфигурации и создали файл ответов, если отобразится подтверждение "Файл ответов успешно создан".

## Шаг 3. Импорт файла конфигурации на целевой сервер

Чтобы импортировать файл конфигурации на целевой сервер, используйте приведенный ниже синтаксис.

    ./ImportEdgeConfig.ps1 -CloneConfigData:"<Configuration file>" -IsImport $true -CloneConfigAnswer:"<answer file>"

Например, чтобы импортировать файл конфигурации C:\\CloneConfigData.xml с помощью файла ответов C:\\CloneConfigAnswer.xml, выполните приведенную ниже команду.

    ./ImportEdgeConfig.ps1 -CloneConfigData:"C:\CloneConfigData.xml" -IsImport $true -CloneConfigAnswer:"C:\CloneConfigAnswer.xml"

## Как проверить, что шаг выполнен?

Вы успешно импортировали файл конфигурации на целевой сервер, если отобразится подтверждение "Импорт данных пограничной конфигурации успешно завершен".

