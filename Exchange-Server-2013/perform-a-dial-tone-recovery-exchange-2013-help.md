---
title: 'Выполнение аварийного восстановления: Exchange 2013 Help'
TOCTitle: Выполнение аварийного восстановления
ms:assetid: 158817fa-4b17-4fa9-8341-a86609e6a388
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Dd979810(v=EXCHG.150)
ms:contentKeyID: 51408005
ms.date: 05/22/2018
mtps_version: v=EXCHG.150
ms.translationtype: MT
---

# Выполнение аварийного восстановления

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2014-06-27_

Переносимость звонка позволяет пользователям отправлять и получать электронную почту с помощью временного почтового ящика во время восстановления или исправления их исходного почтового ящика. Временный почтовый ящик может находиться на том же сервере почтовых ящиков Exchange 2013 или на любом другом сервере почтовых ящиков Exchange 2013 в организации. Процесс использования переносимости аварийного восстановления называется аварийным восстановлением, которое включает в себя также создание пустой базы данных на сервере почтовых ящиков для замены неисправной базы данных. Дополнительные сведения см. в разделе [Переносимость аварийного восстановления](dial-tone-portability-exchange-2013-help.md).

## Что нужно знать перед началом работы

  - Предполагаемое время для завершения: 5 минут плюс время, необходимое для восстановления данных.

  - Для создания аварийной базы данных количество развернутых баз данных не должно превышать установленное максимальное количество. Exchange 2013 Standard Edition поддерживает до пяти баз данных для каждого сервера. Выпуск Exchange 2013 Enterprise Edition поддерживает не более 50 баз данных на сервер в версии RTM и накопительном пакете обновления 1 (CU1) и не более 100 баз данных на серверах в накопительном пакете обновления 2 (CU2) и более поздних.

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись "Восстановление почтового ящика" в разделе [Разрешения получателей](recipients-permissions-exchange-2013-help.md).

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

> [!TIP]  
> Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>..


## Использование командной консоли Exchange для выполнения аварийного восстановления на одном сервере

> [!NOTE]  
> Невозможно использовать Центр администрирования Exchange для выполнения аварийного восстановления на одном сервере.


1.  Убедитесь, что все существующие файлы восстанавливаемой базы данных сохраняются на случай необходимости восстановления в дальнейшем.

2.  Используйте командлет [New-MailboxDatabase](https://technet.microsoft.com/ru-ru/library/aa997976\(v=exchg.150\)) для создания аварийной базы данных, как показано в следующем примере.
    
        New-MailboxDatabase -Name DTDB1 -EdbFilePath D:\DialTone\DTDB1.EDB

3.  Используйте командлет [Set-Mailbox](https://technet.microsoft.com/ru-ru/library/bb123981\(v=exchg.150\)) для перемещения почтовых ящиков пользователей, сохраненных в восстанавливаемой базе данных, как показано в следующем примере.
    
        Get-Mailbox -Database DB1 | Set-Mailbox -Database DTDB1

4.  Используйте командлет [Mount-Database](https://technet.microsoft.com/ru-ru/library/aa998871\(v=exchg.150\)) для подключения базы данных, чтобы разрешить клиентским компьютерам получать к ней доступ, а также отправлять и получать сообщения, как показано в следующем примере.
    
        Mount-Database -Identity DTDB1

5.  Создайте базу данных восстановления и восстановите или скопируйте базу данных и файлы журнала, содержащие данные, которые необходимо восстановить, в базу данных восстановления. Дополнительные сведения см. в разделе [Создание базы данных восстановления](create-a-recovery-database-exchange-2013-help.md).

6.  После копирования данных в базу данных восстановления, но перед подключением восстановленной базы данных, необходимо скопировать все файлы журнала из неисправной базы данных в папку журналов базы данных восстановления, чтобы их можно было просматривать в восстановленной базе данных.

7.  Подключите базу данных восстановления, а затем используйте командлет [Dismount-Database](https://technet.microsoft.com/ru-ru/library/bb124936\(v=exchg.150\)), чтобы отключить ее, как показано в следующем примере.
    
        Mount-Database -Identity RDB1
        Dismount-Database -Identity RDB1

8.  После отключения базы данных восстановления переместите текущую базу данных и файлы журнала из папки базы данных восстановления в безопасное местоположение. Это необходимо для подготовки к переключению с базы данных восстановления на аварийную базу данных.

9.  Отключите аварийную базу данных, как показано в следующем примере. Обратите внимание, что во время отключения базы данных прерывается обслуживание конечных пользователей.
    
        Dismount-Database -Identity DTDB1

10. Переместите базу данных и файлы журнала из папки аварийной базы данных в папку базы данных восстановления.

11. Переместите базу данных и файлы журнала из безопасного местоположения, содержащего восстановленную базу данных, в папку аварийной базы данных, а затем подключите базу данных, как показано в следующем примере.
    
        Mount-Database -Identity DTDB1
    
    Это возобновит обслуживание конечных пользователей. Пользователи смогут получить доступ к исходной рабочей базе данных, а также отправлять и получать сообщения.

12. Подключите базу данных восстановления, как показано в следующем примере.
    
        Mount-Database -Identity RDB1

13. Используйте командлеты [Get-Mailbox](https://technet.microsoft.com/ru-ru/library/bb123685\(v=exchg.150\)) и [New-MailboxRestoreRequest](https://technet.microsoft.com/ru-ru/library/ff829875\(v=exchg.150\)) для экспорта данных из базы данных восстановления и их импорта в восстановленную базу, как показано в следующем примере. Все сообщения, отправленные и полученные с помощью аварийной базы данных, будут импортированы в рабочую базу данных.
    
    ```
    $mailboxes = Get-Mailbox -Database DTDB1
    ```
    ```    
    $mailboxes | %{ New-MailboxRestoreRequest -SourceStoreMailbox $_.ExchangeGuid -SourceDatabase RDB1 -TargetMailbox $_ }
    ```

14. После завершения операции восстановления можно отключить и удалить базу данных восстановления, как показано в следующем примере.
    
    ```
    Dismount-Database -Identity RDB1
    Remove-MailboxDatabase -Identity RDB1
    ```

Дополнительные сведения о синтаксисе и параметрах см. в следующих разделах:

  - [New-MailboxDatabase](https://technet.microsoft.com/ru-ru/library/aa997976\(v=exchg.150\))

  - [Get-Mailbox](https://technet.microsoft.com/ru-ru/library/bb123685\(v=exchg.150\))

  - [Set-Mailbox](https://technet.microsoft.com/ru-ru/library/bb123981\(v=exchg.150\))

  - [Mount-Database](https://technet.microsoft.com/ru-ru/library/aa998871\(v=exchg.150\))

  - [Dismount-Database](https://technet.microsoft.com/ru-ru/library/bb124936\(v=exchg.150\))

  - [Remove-MailboxDatabase](https://technet.microsoft.com/ru-ru/library/aa997931\(v=exchg.150\))

## Как проверить, что все получилось?

Чтобы убедиться, что почтовый ящик успешно перемещен, выполните следующие действия.

  - Откройте почтовый ящик с помощью Microsoft Office Outlook Web App.

  - Откройте почтовый ящик с помощью Microsoft Outlook.

