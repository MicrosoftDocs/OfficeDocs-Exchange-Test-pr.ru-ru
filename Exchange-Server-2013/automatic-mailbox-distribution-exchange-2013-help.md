---
title: 'Автоматическое распределение почтовых ящиков: Exchange 2013 Help'
TOCTitle: Автоматическое распределение почтовых ящиков
ms:assetid: f4db4636-948c-466b-839c-300c1a3a9544
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Ff477621(v=EXCHG.150)
ms:contentKeyID: 59636082
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Автоматическое распределение почтовых ящиков

 

_**Применимо к:** Exchange Server 2010 Service Pack 2 (SP2), Exchange Server 2013_

_**Последнее изменение раздела:** 2013-08-13_

При создании или перемещении почтового ящика или при включении поддержки почты для существующего пользователя этот почтовый ящик должен храниться в базе данных почтовых ящиков. В Microsoft Exchange Server 2013 можно позволить Exchange выбрать нужную базу данных, используя автоматическое распределение почтовых ящиков.

При использовании автоматического распределения почтовых ящиков Exchange просматривает базы данных почтовых ящиков в организации, исключает базы данных, которые не подходят по приведенным ниже в разделе критериям, а затем случайным образом выбирает базу данных для размещения почтового ящика. Данный процесс осуществляет случайное распределение почтовых ящиков по всем подходящим базам данных почтовых ящиков в организации.

Автоматическое распределение используется, когда не указан параметр *Database* для командлетов **New-Mailbox** и **Enable-Mailbox** или параметр *TargetDatabase* для командлета **New-MoveRequest**.

> [!NOTE]  
> Автоматическое распределение почтовых ящиков осуществляется только при создании почтового ящика на сервере Exchange 2013, при перемещении почтового ящика на сервер Exchange 2013 или при включении поддержки почты для пользователя. Командлеты <strong>New-Mailbox</strong>, <strong>New-MoveRequest</strong> и <strong>Enable-Mailbox</strong> должны запускаться с сервера, на котором запущен Exchange 2013. Exchange не выполняет автоматическое перераспределение почтовых ящиков для балансировки нагрузки между базами данных в зависимости от нагрузки на сервер.


Следующий процесс используется для поиска подходящей базы данных почтовых ящиков, в которой необходимо разместить созданный или перемещенный почтовый ящик:

1.  Exchange извлекает список баз данных почтовых ящиков в организации Exchange 2013.

2.  Любая база данных почтовых ящиков, помеченная для исключения из процесса распределения, удаляется из списка доступных баз данных. Исключением баз данных можно управлять. Дополнительные сведения см. в подразделе Исключение баз данных из автоматического распределения далее в этом разделе.

3.  Любая база данных почтовых ящиков, которая расположена за пределами областей управления базами данных, назначенных выполняющему операцию администратору, удаляется из списка доступных баз данных. Дополнительные сведения см. в подразделе Области баз данных далее в этом разделе.

4.  Любая база данных почтовых ящиков, расположенная за пределами локального сайта Active Directory, на котором выполняется операция, удаляется из списка доступных баз данных.

5.  Из списка оставшихся баз данных почтовых ящиков Exchange случайным образом выбирает базу данных. Если эта база данных подключена к сети и работоспособна, она используется системой Exchange. Если она отключена от сети или неработоспособна, случайным образом выбирается другая база данных. Если подключенные к сети и работоспособные базы данных не найдены, операция завершается с ошибкой.

Процедура выбора базы данных почтовых ящиков выполняется агентом расширения командлета Mailbox Resources Management Agent. `Mailbox Resources Management Agent` — это один из нескольких агентов расширения командлета, которые расширяют функциональные возможности запущенных командлетов. Дополнительные сведения об агентах расширения командлета см. в разделе [Агенты расширения командлета](cmdlet-extension-agents-exchange-2013-help.md).

Если требуется, чтобы почтовые ящики не распределялись автоматически, можно отключить `Mailbox Resources Management Agent`. При отключении агента это изменение применяется для всей организации Exchange. Дополнительные сведения об отключении агентов расширения командлета см. в разделе [Управление агентами расширения командлетов](manage-cmdlet-extension-agents-exchange-2013-help.md).

## Исключение баз данных из автоматического распределения

По умолчанию для сохранения созданного или перемещенного почтового ящика функцией автоматического распределения почтовых ящиков могут выбираться все подключенные к сети и работоспособные базы данных почтовых ящиков на серверах Exchange 2013 локального сайта Active Directory. Однако по различным причинам может потребоваться исключить некоторые базы данных из процедуры распределения. Например, база данных почтовых ящиков может быть выделена в качестве базы данных ведения журнала, в которой должны храниться только указанные вручную почтовые ящики. Или может потребоваться временно приостановить использование базы данных для проведения планового обслуживания. В Exchange 2013 можно на время или навсегда исключать базы данных из процедуры распределения с помощью параметра *IsExcludedFromProvisioning*, который можно установить с помощью командлета **Set-MailboxDatabase**.

> [!NOTE]  
> Два других параметра, <em>IsSuspendedFromProvisioning</em> и <em>IsExcludedFromInitialProvisioning</em>, также доступны в командлете <strong>Set-MailboxDatabase</strong>. Они будут удалены в следующей версии Exchange, и их использование не поддерживается.


Параметр *IsExcludedFromProvisioning* имеет два допустимых значения, `$True`.и `$False`. Если установлено значение `$True`, то база данных почтовых ящиков исключается автоматического распределения. Если установлено значение `$False`, то база данных почтовых ящиков включается в автоматическое распределение. По умолчанию используется значение `$False`.

Чтобы исключить базу данных почтовых ящиков из автоматического распределения, используйте следующую команду:

    Set-MailboxDatabase <database name> -IsExcludedFromProvisioning $True

Когда база данных почтовых ящиков исключена из автоматического распределения, то единственный способ создания почтового ящика в этой базе данных или перемещения почтового ящика в нее заключается в использовании параметра *Database* в командлетах **New-Mailbox** и **Enable-Mailbox** или параметра *TargetDatabase* в командлете **New-MoveRequest**.

## Области баз данных

Области управления базами данных представляют собой дополнительный уровень контроля процедуры автоматического распределения почтовых ящиков и появились в Exchange 2013. Если база данных почтовых ящиков подключена к сети и работоспособна, находится на локальном сайте Active Directory и не исключена из автоматического распределения почтовых ящиков, Exchange 2013 проверяет вхождение этой базы данных в область баз данных, назначенную администратору, который запустил данный командлет. Если она входит в эту область баз данных, база данных включается в список баз данных, доступных для данного администратора.

Области баз данных являются частью модели разрешений управления доступом на основе ролей (RBAC). Дополнительные сведения о RBAC и областях баз данных см. в следующих разделах:

  - [Общие сведения об управлении доступом на основе ролей](understanding-role-based-access-control-exchange-2013-help.md)

  - [Общие сведения об областях ролей управления](understanding-management-role-scopes-exchange-2013-help.md)

Области баз данных удобно использовать при наличии большого количества баз данных почтовых ящиков на локальном сайте Active Directory, доступных для автоматического распределения, когда требуется ограничить базы данных, доступные для использования различным группам администраторов. Например, серверы Exchange 2013 могут обслуживать несколько агентств, но требуется разрешить каждому из агентств создавать или перемещать только назначенные ему базы данных почтовых ящиков.

По умолчанию все администраторы в организации Exchange 2013 могут просматривать все базы данных почтовых ящиков в организации. Чтобы ограничить число доступных для просмотра баз данных и таким образом ограничить число баз данных, которые администраторы могут использовать для создания или перемещения почтовых ящиков, необходимо выполнить следующие действия.

1.  С помощью командлета **New-ManagementScope** создайте настраиваемую область управления базами данных, включающую в себя только те базы данных почтовых ящиков, которые должен использовать администратор.

2.  Сопоставьте новую область баз данных с назначением роли управления одним из следующих способов.
    
      - Добавьте новую область баз данных в существующее назначение роли управления, используя параметр *CustomConfigWriteScope* командлета **Set-ManagementRoleAssignment**. Теперь область баз данных назначена группе ролей управления, универсальной группе безопасности (USG) или пользователю, которым назначено назначение роли.
    
      - Создайте назначение роли управления с помощью командлета **New-ManagementRoleAssignment** и используйте параметр *CustomConfigWriteScope* для указания новой области баз данных. Назначение роли можно создать между ролью управления и группой ролей, универсальной группой безопасности или пользователем.

3.  Если назначение роли создано для группы ролей или универсальной группы безопасности, добавьте пользователей в эту группу ролей или универсальную группу безопасности, чтобы назначение роли и область базы данных были назначены этим пользователям.

4.  При необходимости удалите пользователя (или пользователей, являющихся членами групп ролей или универсальных групп безопасности, которые были созданы в предыдущих действиях), которому назначено новое назначение роли, из всех групп ролей или универсальных групп безопасности, которые могут быть назначены области баз данных, содержащей базы данных, доступ к которым требуется запретить.

5.  Убедитесь, что администраторы имеют доступ только к необходимым им базам данных.

После выполнения этих действий администраторы, которым назначены назначения ролей с созданными областями баз данных, смогут использовать для создания или перемещения почтовых ящиков только указанные вами базы данных.

Дополнительные сведения об использовании областей баз данных для ограничения числа доступных администраторам баз данных почтовых ящиков см. в разделе [Управление автоматическим распределением почтовых ящиков с помощью областей базы данных](control-automatic-mailbox-distribution-using-database-scopes-exchange-2013-help.md).

