---
title: 'Организация очередей с учетом приоритетов: Exchange 2013 Help'
TOCTitle: Организация очередей с учетом приоритетов
ms:assetid: 6edbd826-fe55-435b-9c63-48e6365c3d09
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Bb691107(v=EXCHG.150)
ms:contentKeyID: 51408046
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Организация очередей с учетом приоритетов

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2015-03-09_

*Организация очередей с учетом приоритетов* — это функция Microsoft Exchange Server 2013, которая позволяет транспортной службе на сервере почтовых ящиков обрабатывать сообщения с учетом их приоритета, заданного отправителем.

Приоритет сообщения задается отправителем в приложении Microsoft Outlook при создании и отправке сообщения. Отправитель может установить в приложении Outlook любое из следующих значений приоритета сообщений:

  - низкая важность;

  - обычная важность;

  - высокая важность.

По умолчанию для сообщений, созданных в приложении Outlook или Outlook Web App, задается обычный приоритет. Приоритет сообщения хранится в поле `X-Priority` в заголовке сообщения.

Каждое сообщение, отправленное или полученное в организации Exchange 2013, перед маршрутизацией и доставкой должно классифицироваться транспортной службой на сервере почтовых ящиков. Классификатор в транспортной службе на сервере почтовых ящиков берет сообщения по одному из очереди передачи и выполняет сопоставление маршрута и получателя, а также преобразование содержимого сообщения, прежде чем поместить его в очередь доставки. Дополнительные сведения см. в разделе [Поток обработки почты](mail-flow-exchange-2013-help.md).

Очереди доставки динамически создаются с учетом назначения сообщений. Дополнительные сведения см. в разделе [Очереди](queues-exchange-2013-help.md).

Все сообщения, имеющие одно и то же назначение, помещаются в одну очередь доставки. Организация очередей с учетом приоритетов влияет на передачу сообщений из очереди доставки на конечный сервер обмена сообщениями. При включении организации очередей с учетом приоритетов сначала по назначению передаются сообщения с высокой важностью, затем сообщения с обычной важностью, а затем сообщения с низкой важностью. Доставка сообщений с учетом приоритетов позволяет определить конкретные требования по времени доставки сообщений для соглашения об условиях обслуживания.

## Параметры настройки организации очередей с учетом приоритетов

За управление поддержкой организации очередей с учетом приоритетов отвечают ключи в XML-файле конфигурации приложения `%ExchangeInstallPath%bin\EdgeTransport.exe.config`. Инструкции по настройке организации очередей с учетом приоритетов см. в разделе [Включение и настройка приоритет очереди](enable-and-configure-priority-queuing-exchange-2013-help.md).

В следующей таблице каждый ключ рассматривается более подробно.

### Ключи организации очередей с учетом приоритетов в файле конфигурации EdgeTransport.exe.config

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>Клавиша</th>
<th>Значение по умолчанию</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>PriorityQueuingEnabled</em></p></td>
<td><p><code>false</code></p></td>
<td><p>Этот ключ включает или отключает организацию очередей с учетом приоритетов в транспортной службе на сервере почтовых ящиков. Для этого ключа допускаются значения <code>true</code> или <code>false</code>.</p>
<p>Если данный ключ имеет значение <code>false</code>, организация очередей с учетом приоритетов отключена, а все ограничения организации очередей сообщений с учетом приоритетов в файле конфигурации EdgeTransport.exe.config игнорируются.</p></td>
</tr>
<tr class="even">
<td><p><em>MaxHighPriorityMessageSize</em></p></td>
<td><p><code>250KB</code></p></td>
<td><p>Этот ключ определяет максимально допустимый размер сообщений с высокой важностью. Если размер сообщения с высокой важностью превышает значение, заданное этим ключом, степень важности данного сообщения автоматически понижается до обычной.</p>
<p>Значение данного ключа должно быть значительно ниже значения параметра <em>MaxSendMessageSize</em> в командлете <strong>Set-TransportConfig</strong>. По умолчанию значение этого параметра — <code>10 MB</code>. Разница между этими двумя значениями обеспечивает согласованное и предсказуемое время доставки сообщений с высокой важностью.</p>
<p>При вводе значения укажите единицы измерения:</p>
<ul>
<li><p>КБ (килобайт)</p></li>
<li><p>МБ (мегабайт)</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><p><em>LowPriorityDelayNotificationTimeout</em></p>
<p><em>NormalPriorityDelayNotificationTimeout</em></p>
<p><em>HighPriorityDelayNotificationTimeout</em></p></td>
<td><p><strong>Низкая</strong>.   <code>8:00:00</code> (8 часов)</p>
<p><strong>Обычная</strong>.   <code>4:00:00</code> (4 часа)</p>
<p><strong>Высокая</strong>.   <code>00:30:00</code> (30 минут)</p></td>
<td><p>Эти ключи определяют время ожидания для уведомлений о задержке доставки (DSN) на основе приоритета сообщений.</p>
<p>После каждого сбоя доставки сообщения транспортная служба создает уведомление о задержке доставки (DSN) и ставит сообщение в очередь на доставку отправителю недоставленного сообщения. Это уведомление о состоянии задержанной доставки отправляется только по истечении заданного интервала ожидания уведомления о задержке и только если недоставленное сообщение не было успешно доставлено в течение этого времени. Данная задержка предотвращает отправку ненужных уведомлений о состоянии задержанной доставки, причинами которой могут быть временные сбои в передаче сообщений.</p>
<p>Чтобы указать значение, введите его как промежуток времени: дд.чч:мм:сс, где дд — дни, чч — часы, мм — минуты и сс — секунды.</p></td>
</tr>
<tr class="even">
<td><p><em>LowPriorityMessageExpirationTimeout</em></p>
<p><em>NormalPriorityMessageExpirationTimeout</em></p>
<p><em>HighPriorityMessageExpirationTimeout</em></p></td>
<td><p><strong>Низкая</strong>.   <code>2.00:00:00</code> (2 дня)</p>
<p><strong>Обычная</strong>.   <code>2.00:00:00</code> (2 дня)</p>
<p><strong>Высокая</strong>.   <code>8:00:00</code> (8 часов)</p></td>
<td><p>Эти ключи определяют максимальный промежуток времени, в течение которого транспортная служба пытается доставить недоставленное сообщение. Если сообщение не удается успешно доставить до истечения интервала ожидания окончания срока действия сообщения, отправитель получает отчет о недоставке, содержащий исходное сообщение или заголовки сообщения.</p>
<p>Чтобы указать значение, введите его как промежуток времени: дд.чч:мм:сс, где дд — дни, чч — часы, мм — минуты и сс — секунды.</p></td>
</tr>
<tr class="odd">
<td><p><em>MaxPerDomainLowPriorityConnections</em></p>
<p><em>MaxPerDomainNormalPriorityConnections</em></p>
<p><em>MaxPerDomainHighPriorityConnections</em></p></td>
<td><p><strong>Низкая</strong>.   2</p>
<p><strong>Обычная</strong>.   15</p>
<p><strong>Высокая</strong>.   3</p></td>
<td><p>Эти ключи определяют максимальное количество подключений к одному удаленному домену, которое может открыть транспортная служба. Исходящие подключения к удаленным доменам выполняются с помощью очередей доставки и соединителей отправки, имеющихся на сервере почтовых ящиков.</p>
<p>Сумма этих трех ключей не должна превышать значение параметра <em>MaxPerDomainOutboundConnections</em> в командлете <strong>Set-TransportService</strong>. По умолчанию значение этого параметра — <code>20</code>.</p></td>
</tr>
</tbody>
</table>


## Влияние организации очередей с учетом приоритетов на другие ограничения сообщений на серверах почтовых ящиков

Для всех сообщений, проходящих через транспортную службу, существуют различные ограничения по количеству повторных попыток, повторных отправок и срокам действия. Подробнее см. в разделе [Ограничения на размер сообщений](message-size-limits-exchange-2013-help.md).

Некоторые ограничения сообщений, доступные в командлете **Set-TransportService**, имеют соответствующие ограничения организации очередей с учетом приоритетов, доступные в файле конфигурации приложения EdgeTransport.exe.config. В приведенной ниже таблице указаны соответствующие ограничения сообщений.

### Ограничения сообщений в командлете Set-TransportService, соответствующие ограничениям организации очередей сообщений с учетом приоритетов в файле конфигурации EdgeTransport.exe.config

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>Источник</th>
<th>Параметр или ключ</th>
<th>Значение по умолчанию</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Set-TransportService</strong></p></td>
<td><p><em>DelayNotificationTimeOut</em></p></td>
<td><p><code>4:00:00</code> (4 часа)</p></td>
</tr>
<tr class="even">
<td><p>EdgeTransport.exe.config</p></td>
<td><p><em>NormalPriorityDelayNotificationTimeout</em></p></td>
<td><p><code>4:00:00</code> (4 часа)</p></td>
</tr>
<tr class="odd">
<td><p><strong>Set-TransportService</strong></p></td>
<td><p><em>MessageExpirationTimeOut</em></p></td>
<td><p><code>2.00:00:00</code> (2 дня)</p></td>
</tr>
<tr class="even">
<td><p>EdgeTransport.exe.config</p></td>
<td><p><em>NormalPriorityMessageExpirationTimeout</em></p></td>
<td><p><code>2.00:00:00</code> (2 дня)</p></td>
</tr>
</tbody>
</table>


Если организация очередей с учетом приоритетов отключена, все ограничения организации очередей с учетом приоритетов в файле конфигурации EdgeTransport.exe.config пропускаются. Все ограничения сообщений в командлете **Set-TransportService** применяются ко всем сообщениям, проходящим через транспортную службу на сервере почтовых ящиков.

Если организация очередей с учетом приоритетов включена, ограничения организации очередей сообщений с учетом приоритетов в файле конфигурации EdgeTransport.exe.config переопределяют соответствующие ограничения сообщений в командлете **Set-TransportService**. Все другие ограничения сообщений в командлете **Set-TransportService** продолжают применяться к сообщениям с низкой, обычной и высокой важностью, проходящим через транспортную службу на сервере почтовых ящиков.

## Параметры пользователя для организации очередей с учетом приоритетов

Командлет **Set-Mailbox** включает параметр *DowngradeHighPriorityMessagesEnabled*. По умолчанию параметр имеет значение `$false`. Если для этого параметра установлено значение `$true`, для любого сообщение с высокой важностью, отправляемого из почтового ящика, важность автоматически понижается до обычной.

