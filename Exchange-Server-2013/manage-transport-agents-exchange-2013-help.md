---
title: 'Управление агентами транспорта: Exchange 2013 Help'
TOCTitle: Управление агентами транспорта
ms:assetid: f15ab7e4-015d-45b1-9c10-f733d7cd2a36
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Bb125175(v=EXCHG.150)
ms:contentKeyID: 50489490
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Управление агентами транспорта

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2015-04-08_

Агенты транспорта используют события SMTP для обработки сообщений, когда они проходят через транспортный конвейер. Большинство встроенных агентов транспорта, заданных в Microsoft Exchange Server 2013, невидимы и неуправляемы. Однако на серверах Exchange в организации можно установить и настроить сторонние агенты транспорта. Дополнительные сведения об агентах транспорта см. в разделе [Агенты транспорта](transport-agents-exchange-2013-help.md).

## Что нужно знать перед началом работы?

  - Предполагаемое время для завершения каждой процедуры: 10 минут

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись «Агенты транспорта» в разделе [Разрешения потока обработки почты](mail-flow-permissions-exchange-2013-help.md).

  - Для выполнения этой процедуры можно использовать только командную консоль.

  - Поддержка устаревших агентов транспорта по умолчанию отключена, но ее можно включить. Дополнительные сведения см. в разделе [Включение поддержки устаревших агентов транспорта](enable-support-for-legacy-transport-agents-exchange-2013-help.md).

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

> [!TIP]  
> Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>.


## Что нужно сделать

## О процедурах агентов транспорта в службе транспорта переднего плана на серверах клиентского доступа

Для управления агентом транспорта в службе транспорта переднего плана на серверах клиентского доступа нельзя использовать командную консоль Exchange. Вместо этого на сервере клиентского доступа нужно открыть Windows PowerShell, а затем импортировать командлеты Exchange в сеанс Windows PowerShell.

> [!CAUTION]  
> Запуск командлетов Exchange в Windows PowerShell для задач кроме управления агентами транспорта в службе транспорта переднего плана не поддерживается. Пропуск командной консоли Exchange и управления доступом на основе ролей (RBAC) при запуске командлетов Exchange в Windows PowerShell может вызвать серьезные последствия. Следует всегда запускать командлеты Exchange в командной консоли Exchange. Дополнительные сведения см. в разделе <a href="release-notes-for-exchange-2013-exchange-2013-help.md">Заметки о выпуске Exchange 2013</a>.


Для выполнения любой процедуры агента транспорта, описанной в этом разделе в службе транспорта переднего плана, нужно выполнить следующие дополнительные действия.

1.  На сервере клиентского доступа откройте Windows PowerShell и выполните команду, приведенную ниже:
    
        Add-PSSnapin Microsoft.Exchange.Management.PowerShell.SnapIn

2.  Запустите команду, как описано, но добавьте к ней следующее значение: `-TransportService FrontEnd`.
    
    Например, для просмотра агентов транспорта в службе транспорта переднего плана выполните команду, приведенную ниже:
    
        Get-TransportAgent -TransportService FrontEnd

## Установка агента транспорта с помощью командной консоли Exchange

При установке агента транспорта Exchange регистрирует только те библиотеки DLL, которые относятся к агенту транспорта. Поэтому все файлы, разделы реестра и другие объекты, влияющие на работу агента транспорта, должны быть установлены и правильно настроены. После загрузки библиотек DLL Exchange продолжает ссылаться на них после завершения выполнения команды.

Агенты транспорта имеют полный доступ ко всем сообщениям электронной почты, обнаруженным ими. Приложение Exchange не накладывает ограничений на поведение агентов транспорта. Нестабильные агенты транспорта или с недостатками в системе безопасности могут повлиять на стабильность и безопасность Exchange. Поэтому устанавливать следует только те агенты транспорта, которые заслуживают полного доверия и были испытаны в лабораторной среде.

Чтобы исключить влияние не настроенных агентов транспорта на передачу почтовых сообщений, после установки они находятся в отключенном состоянии. Поэтому после правильной настройки агента транспорта его необходимо включить.

Чтобы установить агент транспорта, используйте следующий синтаксис.

    Install-TransportAgent -Name <TransportAgentIdentity> -TransportAgentFactory <"TransportAgentFactory"> -AssemblyPath <"FilePath">

В этом примере фиктивный агент транспорта Contoso Transport Agent устанавливается в службе транспорта на сервере почтовых ящиков.

    Install-TransportAgent -Name "Contoso Transport Agent" -TransportAgentFactory "vendor.exchange.ContosoTransportAgentfactory" -AssemblyPath "C:\Program Files\Vendor\TransportAgent\ContosoTransportAgentFactory.dll"

## Как проверить, что все получилось?

Для проверки успешной установки агента транспорта выполните команду `Get-TransportAgent` и убедитесь, что агент транспорта отображается в списке.

## Включение агента транспорта с помощью командной консоли Exchange

Чтобы включить агент транспорта, используйте следующий синтаксис.

    Enable-TransportAgent <TransportAgentIdentity>

В этом примере фиктивный агент транспорта Contoso Transport Agent включается в службе транспорта на сервере почтовых ящиков.

    Enable-TransportAgent "Contoso Transport Agent"

## Как проверить, что все получилось?

Для проверки успешного включения агента транспорта выполните команду `Get-TransportAgent | Format-List Name,Enabled` и убедитесь, что агент транспорта включен.

## Отключение агента транспорта с помощью командной консоли Exchange

Чтобы отключить агент транспорта, используйте следующий синтаксис:

    Disable-TransportAgent <TransportAgentIdentity>

В этом примере фиктивный агент транспорта Fabirkam Transport Agent отключается в службе транспорта на сервере почтовых ящиков.

    Disable-TransportAgent "Fabrikam Transport Agent"

## Как проверить, что все получилось?

Для проверки успешного отключения агента транспорта выполните команду `Get-TransportAgent | Format-List Name,Enabled` и убедитесь, что агент транспорта отключен.

## Просмотр агента транспорта с помощью командной консоли Exchange

Чтобы просмотреть сводный список всех агентов транспорта, выполните следующую команду:

    Get-TransportAgent

Чтобы просмотреть подробные сведения о конфигурации определенного агента транспорта, выполните следующую команду:

    Get-TransportAgent <TransportAgentIdentity> | Format-List

В этом примере предоставляются подробные сведения о конфигурации агента транспорта Transport Rule Agent.

    Get-TransportAgent "Transport Rule Agent" | Format-List

## Настройка приоритета агента транспорта с помощью командной консоли Exchange

Агенты транспорта, для которых значение приоритета близко к нулю, обрабатывают сообщения электронной почты в первую очередь. Однако событие SMTP в транспортном конвейере, где зарегистрирован агент транспорта, может стать причиной того, что агенты с низким приоритетом будут обрабатывать сообщения раньше агентов с высоким приоритетом.

Чтобы изменить приоритет существующего агента транспорта, выполните следующую команду:

    Set-TransportAgent <TransportAgentIdentity> -Priority <Integer>

В этом примере для существующего агента транспорта Contoso Transport Agent устанавливается значение приоритета агента 3 в службе транспорта на сервере почтовых ящиков.

    Set-TransportAgent "Contoso Transport Agent" -Priority 3

## Как проверить, что все получилось?

Для проверки успешной настройки приоритета агента транспорта выполните команду `Get-TransportAgent | Format-List Name,Priority` и проверьте значение приоритета агента транспорта.

## Удаление агента транспорта с помощью командной консоли Exchange

При удалении агента транспорта Exchange отменяет регистрацию используемых агентом файлов DLL. При этом файлы, разделы реестра или другие объекты, добавляемые при установке агента транспорта, Exchange не удаляет.

Для удаления агента транспорта выполните следующую команду:

    Uninstall-TransportAgent <TransportAgentIdentity>

В этом примере фиктивный агент транспорта Fabrikam Transport Agent удаляется из службы транспорта на сервере почтовых ящиков.

    Uninstall-TransportAgent "Fabrikam Transport Agent"

## Как проверить, что все получилось?

Для проверки успешного удаления агента транспорта выполните команду `Get-TransportAgent` и убедитесь, что агент транспорта не отображается в списке.

