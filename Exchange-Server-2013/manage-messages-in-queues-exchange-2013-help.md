---
title: 'Управление сообщениями в очередях: Exchange 2013 Help'
TOCTitle: Управление сообщениями в очередях
ms:assetid: 83358884-6036-4e91-87a8-35200541874d
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Bb123535(v=EXCHG.150)
ms:contentKeyID: 51408054
ms.date: 05/22/2018
mtps_version: v=EXCHG.150
ms.translationtype: MT
---

# Управление сообщениями в очередях

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2014-05-07_

Для управления сообщениями в очередях в Microsoft Exchange Server 2013 можно использовать средство просмотра очереди на панели инструментов Exchange или в командной консоли Exchange. Дополнительные сведения об использовании командлетов управления сообщениями в командной консоли Exchange см. в разделе [Использование командной консоли Exchange для управления очередями](use-the-exchange-management-shell-to-manage-queues-exchange-2013-help.md).

## Что нужно знать перед началом работы

  - Предполагаемое время для завершения каждой процедуры: 15 минут.

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись "Очереди" в разделе [Разрешения потока обработки почты](mail-flow-permissions-exchange-2013-help.md).

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

> [!TIP]  
> Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>.


## Что необходимо сделать?

## Удаление сообщений из очередей

Сообщение, отправляемое нескольким получателям, может находиться в нескольких очередях. Чтобы удалить сообщение из нескольких очередей за одну операцию, следует использовать фильтр. При удалении сообщений из очереди можно указать, должен ли отправляться отчет о недоставке. Невозможно удалить сообщение из очереди "Отправка".

## Использовать средство просмотра очереди на панели инструментов Exchange для удаления сообщений

1.  Нажмите кнопку **Пуск** и последовательно выберите пункты **Все программы** \> **Microsoft Exchange 2013** \> **Панель элементов Exchange**.

2.  В разделе **Средства для потока почты** дважды щелкните **Средство просмотра очереди**, чтобы открыть средство в новом окне.

3.  В средстве просмотра очереди перейдите на вкладку **Сообщения**. Отобразится список всех сообщений на сервере, к которому установлено подключение. Чтобы настроить действие в отдельной очереди, откройте вкладку **Очереди**, дважды щелкните имя очереди, а затем откройте вкладку *Сервер\\Очередь*.

4.  Выделите одно или несколько сообщений в списке, щелкните правой кнопкой мыши и выберите команду **Удалить сообщения (с отправкой отчета о недоставке)** или **Удалить сообщения (без отчета о недоставке)**. Отобразится диалоговое окно с подтверждением выбранного действия и запросом **Продолжить?** Нажмите кнопку **Да**.

5.  Чтобы удалить все сообщения из конкретной очереди, откройте вкладку **Очереди**. Выберите очередь, щелкните ее правой кнопкой мыши и выберите команду **Удалить сообщения (с отправкой отчета о недоставке)** или **Удалить сообщения (без отчета о недоставке)**. Отобразится диалоговое окно с подтверждением выбранного действия и запросом **Продолжить?** Нажмите кнопку **Да**.
    
    > [!NOTE]  
    > При работе с отфильтрованным списком отображаемая страница может содержать не все элементы в фильтре. В этом случае появится запрос: <strong>Это действие повлияет на все элементы этой страницы. Чтобы расширить область применения этого действия для включения всех элементов в этом фильтре, установите следующий флажок до нажатия кнопки «OK».</strong>


## Использовать командную консоль для удаления сообщений

Чтобы удалить сообщения из очередей, введите команду в следующем формате.

    Remove-Message <-Identity MessageIdentity | -Filter {MessageFilter}> -WithNDR <$true | $false>

В этом примере из очереди удаляются сообщения с темой "Win Big" без отправки отчета о недоставке.

```powershell
Remove-Message -Filter {Subject -eq "Win Big"} -WithNDR $false
```

В этом примере из очереди недоставленных сообщений на сервере с именем Mailbox01 удаляются сообщения с идентификатором сообщения 3 с отправкой отчета о недоставке.

```powershell
Remove-Message -Identity Mailbox01\Unreachable\3 -WithNDR $true
```

## Как проверить, что все получилось?

Чтобы убедиться в успешности удаления сообщений из очередей, выполните одно из следующих действий.

  - В средстве просмотра очереди выберите очередь или создайте фильтр для проверки, что сообщение больше не существует.

  - Чтобы проверить, что сообщение больше не существует, используйте командлет **Get-Message** с параметрами *Queue* или *Filter*. Подробнее см. в разделе [Get-Message](https://technet.microsoft.com/ru-ru/library/bb124738\(v=exchg.150\)).

## Возобновление доставки сообщений, находящихся в очередях

Можно возобновить передачу сообщения, которое в текущий момент имеет состояние «Приостановлено». Посредством возобновления передачи сообщения включается доставка сообщения. Если возобновляется передача сообщения, находящегося в очереди подозрительных сообщений, то сообщение будет отправлено в классификатор для обработки. Сообщение, отправляемое нескольким получателям, может находиться в нескольких очередях. Чтобы возобновить передачу сообщения в нескольких очередях за одну операцию, следует использовать фильтр.

## Использовать средство просмотра очереди на панели инструментов Exchange для возобновления сообщений

1.  Нажмите кнопку **Пуск** и последовательно выберите пункты **Все программы** \> **Microsoft Exchange 2013** \> **Панель элементов Exchange**.

2.  В разделе **Средства для потока почты** дважды щелкните **Средство просмотра очереди**, чтобы открыть средство в новом окне.

3.  В средстве просмотра очереди перейдите на вкладку **Сообщения**. Отобразится список всех сообщений на сервере, к которому установлено подключение. Чтобы настроить действие на обработку одной очереди, откройте вкладку **Очереди**, дважды щелкните имя очереди, а затем откройте появившуюся вкладку *Сервер\\Очередь*.

4.  Щелкните **Создать фильтр** и введите выражение фильтра следующим образом:
    
    1.  Выберите **Состояние** в раскрывающемся списке свойств сообщения.
    
    2.  Выберите пункт **Равно** из раскрывающегося списка операторов сравнения.
    
    3.  Выберите **Приостановлено** в раскрывающемся списке значений.

5.  Нажмите кнопку **Применить фильтр**. Отобразятся все сообщения, имеющие состояние «Приостановлено».

6.  Выделите одно или несколько сообщений в списке, щелкните правой кнопкой мыши и выберите команду **Возобновить**.

## Использовать командную консоль для возобновления сообщений

Для возобновления сообщений введите команду в следующем формате.

```powershell
Resume-Message <-Identity MessageIdentity | -Filter {MessageFilter}>
```

В данном примере возобновляется передача всех сообщений от всех отправителей в домене Contoso.com.

    Resume-Message -Filter {FromAddress -eq "*contoso.com"}

В данном примере возобновляется передача сообщения с идентификатором сообщения 3 в недоступной очереди на сервере Hub01.

```powershell
Resume-Message -Identity Hub01\Unreachable\3
```

Чтобы повторно отправить сообщения из очереди подозрительных сообщений, выполните следующие действия.

## Как проверить, что все получилось?

Чтобы убедиться в успешности восстановления сообщений в очереди, выполните одно из следующих действий.

  - В средстве просмотра очереди выберите очередь или создайте фильтр для проверки, что сообщение больше не находится в приостановленном состоянии.

  - Чтобы проверить, что сообщения больше не находятся в приостановленном состоянии, используйте командлет **Get-Message** с параметрами *Queue* или *Filter*. Подробнее см. в разделе [Get-Message](https://technet.microsoft.com/ru-ru/library/bb124738\(v=exchg.150\)).

Обратите внимание, что если сообщения нет ни в одной из очередей на сервере, скорее всего, оно было доставлено до следующего прыжка.

## Приостановка сообщений, находящихся в очередях

Приостановка сообщения приводит к предотвращению его доставки. Если сообщение появляется в очереди, но уже находится в процессе доставки, то его доставку приостановить нельзя. Доставка будет продолжена, а сообщение перейдет в состояние **PendingSuspend**. Если доставка не удалась, сообщение будет повторно поставлено в очередь, а затем его доставка будет приостановлена. Отправку сообщения, которое находится в очереди передачи или в очереди подозрительных сообщений, приостановить нельзя.

Сообщение, отправляемое нескольким получателям, может находиться в нескольких очередях. Чтобы приостановить сообщение в нескольких очередях за одну операцию, необходимо применить фильтр.

## Использование средства просмотра очереди на панели инструментов Exchange для приостановки сообщений

1.  Нажмите кнопку **Пуск** и последовательно выберите пункты **Все программы** \> **Microsoft Exchange 2013** \> **Панель элементов Exchange**.

2.  В разделе **Средства для потока почты** дважды щелкните **Средство просмотра очереди**, чтобы открыть средство в новом окне.

3.  В средстве просмотра очереди перейдите на вкладку **Сообщения**. Отобразится список всех сообщений на сервере, к которому установлено подключение. Чтобы ограничить просмотр одной очередью, откройте вкладку **Очереди**, дважды щелкните имя очереди, а затем откройте появившуюся вкладку *Сервер\\Очередь*.

4.  Выберите одно или несколько сообщений, щелкните правой кнопкой мыши и выберите команду **Приостановить**

## Использование командной консоли для приостановки сообщений

Для приостановки сообщений введите команду в следующем формате.

```powershell
Suspend-Message <-Identity MessageIdentity | -Filter {MessageFilter}>
```

В следующем примере производится приостановка всех сообщений в очередях от любых отправителей в домене Contoso.com.

    Suspend-Message -Filter {FromAddress -eq "*contoso.com"}

В этом примере производится приостановка сообщения с идентификатором 3 в очереди недоставленных сообщений на сервере с именем Mailbox01.

```powershell
Suspend-Message -Identity Mailbox01\Unreachable\3
```

## Как проверить, что все получилось?

Чтобы убедиться в успешности приостановления сообщений в очереди, выполните одно из следующих действий.

  - В средстве просмотра очереди выберите очередь или создайте фильтр для проверки, что сообщение приостановлено.

  - Чтобы проверить, что сообщения приостановлены, используйте командлет **Get-Message** с параметрами *Queue* или *Filter*. Подробнее см. в разделе [Get-Message](https://technet.microsoft.com/ru-ru/library/bb124738\(v=exchg.150\)).

