---
title: 'Exchange 2013: перенос пути базы данных почтовых ящиков для копии такой базы'
TOCTitle: Перемещение пути базы данных почтовых ящиков для копии базы данных почтовых ящиков
ms:assetid: 324f255c-d95d-4a8a-a134-c8cee5c5b9cb
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Dd979782(v=EXCHG.150)
ms:contentKeyID: 50487772
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Перемещение пути базы данных почтовых ящиков для копии базы данных почтовых ящиков

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2014-05-07_

После создания базы данных почтовых ящиков вы можете переместить ее на другой том, в другую папку или другое расположение, используя EAC или командную консоль. Пошаговые инструкции по перемещению нереплицированной базы данных почтовых ящиков см. в разделе [Move a mailbox database path](manage-mailbox-databases-in-exchange-2013-exchange-2013-help.md).

Если база данных почтовых ящиков, путь к которой изменяется, реплицируется в одну или несколько копий базы данных, необходимо выполнить описанную в этом разделе процедуру, чтобы изменить путь к базе данных. Все копии базы данных почтовых ящиков должны иметь одинаковый путь на каждом сервере, на котором размещена копия. Например, если база данных DB1 имеет путь C:\\mountpoints\\DB1 на сервере EX1, копии DB1 на серверах EX2, EX3 и др. также должны иметь путь C:\\mountpoints\\DB1.

Необходимы сведения о других задачах управления, связанных с копиями базы данных почтовых ящиков? см. в разделе [Управление копиями баз данных почтовых ящиков](managing-mailbox-database-copies-exchange-2013-help.md).

## Что нужно знать перед началом работы?

  - Предполагаемое время выполнения задачи: 2 минуты, а также время на перемещение данных, которое зависит от ряда факторов, например размера базы данных, скорости, доступной полосы пропускания и задержки сети, а также скорости работы хранилища.

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись "Копии базы данных почтовых ящиков" в разделе [Разрешения высокого уровня доступности и устойчивости сайта](high-availability-and-site-resilience-permissions-exchange-2013-help.md).

  - Чтобы выполнить операцию перемещения, база данных должна быть временно отключена, что сделает ее недоступной для всех пользователей. Если база данных отключена перед операцией, она не будет подключена после выполнения операции.

  - При выполнении операции по изменению пути репликация базы данных должна быть отключена для всех копий. Недостаточно приостановить репликацию. Для удаления копий базы данных ее необходимо отключить с помощью командлета [Remove-MailboxDatabaseCopy](https://technet.microsoft.com/ru-ru/library/dd335119\(v=exchg.150\)).

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

> [!TIP]  
> Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>..


## Использование командной консоли Exchange для изменения пути к реплицированной базе данных почтовых ящиков

> [!NOTE]  
> Вы не можете использовать EAC для перемещения реплицированной базы данных почтовых ящиков в новое расположение.


1.  Обратите внимание на любые параметры запаздывания преобразования и усечения для всех копий перемещаемой базы данных почтовых ящиков. Эти сведения можно получить с помощью командлета [Get-MailboxDatabase](https://technet.microsoft.com/ru-ru/library/bb124924\(v=exchg.150\)), как показано в этом примере.
    
        Get-MailboxDatabase DB1 | Format-List *lag*

2.  Если для базы данных включено циклическое ведение журнала, его необходимо отключить перед продолжением работы. Циклическое ведение журнала можно отключить для базы данных почтовых ящиков с помощью командлета [Set-MailboxDatabase](https://technet.microsoft.com/ru-ru/library/bb123971\(v=exchg.150\)), как показано в этом примере.
    
        Set-MailboxDatabase DB1 -CircularLoggingEnabled $false

3.  Удалите все копии базы данных почтовых ящиков для перемещаемой базы данных Дополнительные сведения см. в разделе [Удаление копии базы данных почтовых ящиков](remove-a-mailbox-database-copy-exchange-2013-help.md). После удаления всех копий сохраните базу данных и файлы журналов транзакций с каждого сервера, с которого удаляется копия базы данных, путем их перемещения в другое местоположение. Эти файлы сохраняются, поэтому для копий базы данных не требуется повторное заполнение после повторного добавления.

4.  Измените путь к базе данных почтовых ящиков. Дополнительные сведения см. в разделе [Move a mailbox database path](manage-mailbox-databases-in-exchange-2013-exchange-2013-help.md).
    
    > [!IMPORTANT]  
    > При выполнении операции перемещения база данных должна быть отключена. Этот процесс приведет к перерыву в обслуживании и отключению всех пользователей, имеющих почтовые ящики в перемещаемой базе данных, до завершения перемещения. После завершения операции перемещения база данных будет автоматически подключена.


5.  Создайте необходимую структуру папок на каждом сервере почтовых ящиков, на котором ранее содержалась пассивная копия перемещенной базы данных почтовых ящиков. Например, если путь к базе данных был изменен на C:\\mountpoints\\DB1, необходимо создать такой же путь на каждом сервере почтовых ящиков, на котором будет храниться копия базы данных почтовых ящиков.

6.  После создания структуры папок переместите пассивную копию базы данных почтовых ящиков, а также ее поток журнала в новое местоположение. Это файлы, которые остались и были сохранены после выполнения шага 3. Повторите этот процесс для каждой копии базы данных, удаленной на шаге 3.

7.  Добавьте все копии базы данных, которые были удалены на шаге 3. Дополнительные сведения см. в разделе [Добавление копии базы данных почтовых ящиков](add-a-mailbox-database-copy-exchange-2013-help.md).

8.  На каждом сервере, на котором расположена копия перемещаемой базы данных почтовых ящиков, запустите следующие команды для остановки и повторного запуска служб индексирования содержимого.
    
        Net stop MSExchangeFastSearch
        Net start MSExchangeFastSearch

9.  При необходимости включите циклическое ведение журналов с помощью командлета [Set-MailboxDatabase](https://technet.microsoft.com/ru-ru/library/bb123971\(v=exchg.150\)), как показано в этом примере.
    
        Set-MailboxDatabase DB1 -CircularLoggingEnabled $true

10. Повторно настройте любые ранее заданные значения времени запаздывания преобразования и времени запаздывания усечения с помощью командлета [Set-MailboxDatabaseCopy](https://technet.microsoft.com/ru-ru/library/dd298104\(v=exchg.150\)), как показано в этом примере.
    
        Set-MailboxDatabaseCopy DB1\MBX2 -ReplayLagTime 00:15:00

11. При добавлении каждой копии рекомендуется проверять ее работоспособность и состояние перед добавлением следующей копии. Работоспособность и состояние можно проверить следующими способами:
    
    1.  Проверка журнала событий на наличие ошибок и событий предупреждений, связанных с базой данных или копией базы данных.
    
    2.  Проверка работоспособности и состояния непрерывной репликации для копии базы данных с помощью командлета [Get-MailboxDatabaseCopyStatus](https://technet.microsoft.com/ru-ru/library/dd298044\(v=exchg.150\)).
    
    3.  Проверка работоспособности и состояния группы доступности базы данных и непрерывной репликации с помощью командлета [Test-ReplicationHealth](https://technet.microsoft.com/ru-ru/library/bb691314\(v=exchg.150\)).

Подробные сведения о синтаксисе и параметрах см. в следующих разделах:

  - [Get-MailboxDatabase](https://technet.microsoft.com/ru-ru/library/bb124924\(v=exchg.150\))

  - [Set-MailboxDatabase](https://technet.microsoft.com/ru-ru/library/bb123971\(v=exchg.150\))

  - [Set-MailboxDatabaseCopy](https://technet.microsoft.com/ru-ru/library/dd298104\(v=exchg.150\))

  - [Get-MailboxDatabaseCopyStatus](https://technet.microsoft.com/ru-ru/library/dd298044\(v=exchg.150\))

  - [Test-ReplicationHealth](https://technet.microsoft.com/ru-ru/library/bb691314\(v=exchg.150\))

## Как проверить, что все получилось?

Чтобы проверить, успешно ли перемещен путь для копии базы данных почтовых ящиков, выполните одно из указанных ниже действий.

  - В Центре администрирования Exchange откройте раздел **Серверы** \> **Базы данных**. Выберите базу данных, которая была скопирована. В области "Сведения" отображается состояние копии базы данных и индекса ее содержимого, а также текущая длина очереди копирования. Убедитесь, что состояние работоспособное.

  - В командной консоли выполните приведенную ниже команду, чтобы убедиться, что копия базы данных почтовых ящиков создана и работоспособна.
    
        Get-MailboxDatabaseCopyStatus <DatabaseCopyName>
    
    Состояние самой копии и индекса содержимого должно быть указано как работоспособное.

