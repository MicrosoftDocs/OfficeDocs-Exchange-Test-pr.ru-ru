---
title: 'Восстановление удаленных сообщений в почтовом ящике пользователя: Exchange 2013 Help'
TOCTitle: Восстановление удаленных сообщений в почтовом ящике пользователя
ms:assetid: 9e0e34ce-efc5-454e-8d15-57b4da867f12
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Ff660637(v=EXCHG.150)
ms:contentKeyID: 50556416
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Восстановление удаленных сообщений в почтовом ящике пользователя

 

_**Применимо к:** Exchange Online, Exchange Server 2013_

_**Последнее изменение раздела:** 2016-12-09_

(Эта статья предназначена для администраторов Exchange.)

Администраторы могут искать и восстанавливать удаленные сообщения электронной почты в почтовом ящике пользователя. Это включает элементы, окончательно удаленные (очищенные) пользователем (с помощью функции восстановления удаленных элементов в Outlook или Outlook Web App), или элементы, удаленные автоматизированным процессом, таким как политика хранения, назначенная почтовым ящикам пользователей. В таких ситуациях пользователь не может восстановить окончательно удаленные элементы. Однако администраторы могут восстановить окончательно удаленные сообщения, пока период хранения удаленных элементов для этого элемента не истек.

> [!NOTE]  
> Эту процедуру можно использовать для поиска и восстановления удаленных элементов (которые перемещены в папку &quot;Элементы с возможностью восстановления&quot; или &quot;Очистка&quot;, если включена функция восстановления одного элемента или судебного удержания), а также для поиска элементов, находящихся в других папках почтового ящика, и для удаления элементов из исходного почтового ящика (такая процедура называется <em>поиск с удалением</em>).


## Что нужно знать перед началом работы?

  - Осталось времени до завершения: 15-30 минут.

  - Для процедур в этом разделе требуются особые разрешения. См. информацию о разрешениях по каждой процедуре.

  - Восстановление отдельного объекта должно быть включено для почтового ящика до того, как элемент, который следует восстанавливать, будет удален. В Exchange Online при создании нового почтового ящика восстановление отдельного элемента включено по умолчанию. В Exchange 2013 при создании почтового ящика восстановление отдельного элемента отключено. Дополнительные сведения см. в статье [Включение или отключение восстановления одного элемента в почтовом ящике](enable-or-disable-single-item-recovery-for-a-mailbox-exchange-2013-help.md).

  - Чтобы найти и восстановить элементы, необходимо указать следующие данные.
    
      - **Исходный почтовый ящик**   Это почтовый ящик, в котором выполняется поиск.
    
      - **Целевой почтовый ящик**   Это почтовый ящик найденных сообщений, в котором будут восстановлены сообщения. Программа установки Exchange создает почтовый ящик найденных сообщений по умолчанию. По умолчанию почтовый ящик найденных сообщений также создается в Exchange Online. При необходимости можно создать дополнительные почтовые ящики найденных сообщений. Дополнительные сведения см. в разделе [Создание почтового ящика обнаружения](create-a-discovery-mailbox-exchange-2013-help.md).
        
        > [!NOTE]  
        > С помощью командлета <strong>Search-Mailbox</strong> можно также указать другой целевой почтовый ящик вместо ящика найденных сообщений. Однако невозможно указать один ящик в качестве исходного и целевого одновременно.
    
      - **Условия поиска**   Условия включают в себя отправителя или получателя либо ключевые слова (слова или фразы) в сообщении.

  - В этой статье основное внимание уделяется восстановлению удаленных элементов в почтовом ящике пользователя с помощью PowerShell. Кроме того, вы можете находить удаленные элементы и экспортировать их в PST-файл с помощью средства обнаружения электронных данных на месте на базе графического пользовательского интерфейса. С помощью этого PST-файла пользователь может восстановить удаленные сообщения в своем почтовом ящике. Подробные указания см. в статье [Восстановление элементов, удаленных из почтового ящика пользователя: справка для администраторов](https://go.microsoft.com/fwlink/p/?linkid=722928).

## (Необязательно) Шаг 1. Подключение к Exchange Online с помощью удаленной оболочки PowerShell

Это действие необходимо выполнять только в том случае, если у вас есть организация Exchange Online или Office 365. Если у вас есть организация Exchange 2013, перейдите к следующему действию и выполните команду в Командная консоль Exchange.

1.  На локальном компьютере откройте Windows PowerShell и запустите следующую команду:
    
        $UserCredential = Get-Credential
    
    В диалоговом окне **Запрос учетных данных Windows PowerShell** введите имя пользователя и пароль учетной записи глобального администратора Office 365, а затем нажмите кнопку **ОК**.

2.  Выполните следующую команду:
    
        $Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/powershell-liveid/ -Credential $UserCredential -Authentication Basic -AllowRedirection

3.  Выполните следующую команду:
    
        Import-PSSession $Session

4.  Убедитесь, что подключение к организации Exchange Online установлено, получив список всех почтовых ящиков в организации с помощью следующей команды:
    
        Get-Mailbox

Дополнительные сведения или варианты решения проблем при подключении к организации Exchange Online см. в статье [Подключение к Exchange Online с помощью удаленной оболочки PowerShell](https://go.microsoft.com/fwlink/p/?linkid=517283).

## Действие 2. Поиск и восстановление отсутствующих элементов

Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье запись "Обнаружение электронных данных на месте" в статье [Политика обмена сообщениями и разрешения для соответствия требованиям](messaging-policy-and-compliance-permissions-exchange-2013-help.md).

> [!NOTE]  
> Для поиска недостающих элементов вы можете использовать функцию обнаружения электронных данных на месте в Центре администрирования Exchange (EAC). Однако при использовании EAC невозможно ограничить поиск папкой восстанавливаемых элементов. Сообщения, соответствующие заданным параметрам поиска, будут возвращены даже в том случае, если они не удалены. После завершения восстановления в указанном почтовом ящике обнаружения, возможно, потребуется просмотреть результаты поиска и удалить ненужные сообщения до того, как провести восстановление оставшихся сообщений в почтовом ящике пользователя или их экспорт в PST-файл.<br />
Дополнительные сведения об использовании EAC для выполнения поиска на месте см. в разделе <a href="create-an-in-place-ediscovery-search-exchange-2013-help.md">Создание поискового запроса на локальное обнаружение электронных данных</a>.


Первым шагом процесса восстановления является поиск сообщений в исходном почтовом ящике. Используйте один из следующих способов поиска в почтовом ящике пользователя и копирования сообщений в почтовый ящик найденных сообщений.

В этом примере показано, как выполнить поиск сообщений в почтовом ящике пользователя April Stewart, соответствующий следующим условиям.

  - Отправитель: Ken Kwok

  - Ключевое слово: Seattle

<!-- end list -->

    Search-Mailbox "April Stewart" -SearchQuery "from:'Ken Kwok' AND seattle" -TargetMailbox "Discovery Search Mailbox" -TargetFolder "April Stewart Recovery" -LogLevel Full

> [!NOTE]  
> При использовании командлета <strong>Search-Mailbox</strong> можно указать область поиска с помощью параметра <em>SearchQuery</em>, чтобы создать запрос, отформатированный с помощью языка Keyword Query Language (KQL). Можно также использовать параметр <em>SearchDumpsterOnly</em> для поиска только элементов в папке элементов для восстановления.


Дополнительные сведения о синтаксисе и параметрах см. в разделе [Search-Mailbox](https://technet.microsoft.com/ru-ru/library/dd298173\(v=exchg.150\)).

**Как проверить, что все получилось?**

Чтобы убедиться в том, что вы успешно нашли сообщения, которые вы хотите восстановить, войдите в почтовый ящик обнаружения, выбранный в качестве целевого почтового ящика, и ознакомьтесь с результатами поиска.

## Шаг 3. Восстановление элементов из папки "Восстановленные"

Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье запись "Обнаружение электронных данных на месте" в статье [Политика обмена сообщениями и разрешения для соответствия требованиям](messaging-policy-and-compliance-permissions-exchange-2013-help.md).

> [!NOTE]  
> Невозможно использовать EAC для восстановления элементов из папки «Восстановленные».


После восстановления сообщений в почтовый ящик найденных сообщений можно восстановить их в почтовый ящик пользователя с помощью командлета **Search-Mailbox**. В Exchange 2013 вы также можете использовать командлеты **New-MailboxExportRequest** и **New-MailboxImportRequest**, чтобы экспортировать сообщения в PST-файл или импортировать сообщения из него.

## Использование командной консоли для восстановления сообщений

В этом примере показано, как восстановить сообщения в почтовый ящик пользователя April Stewart и удалить их из почтового ящика найденных сообщений.

    Search-Mailbox "Discovery Search Mailbox" -SearchQuery "from:'Ken Kwok' AND seattle" -TargetMailbox "April Stewart" -TargetFolder "Recovered Messages" -LogLevel Full -DeleteContent

Дополнительные сведения о синтаксисе и параметрах см. в разделе [Search-Mailbox](https://technet.microsoft.com/ru-ru/library/dd298173\(v=exchg.150\)).

**Как проверить, что все получилось?**

Для проверки успешного восстановления сообщений в почтовом ящике пользователя пользователю необходимо просмотреть сообщения в целевой папке, указанной в команде, приведенной выше.

## Использование командной консоли для экспорта сообщений в PST-файл и импорта сообщений из него (Exchange 2013)

В Exchange 2013 можно экспортировать содержимое из почтового ящика в PST-файл и импортировать содержимое PST-файла в почтовый ящик. Дополнительные сведения об импорте и экспорте в почтовом ящике см. в разделе [Запросы на импорт и экспорт почтовых ящиков](mailbox-import-and-export-requests-exchange-2013-help.md). Это действие нельзя выполнить в Exchange Online.

В этом примере для экспорта сообщений из папки "April Stewart Recovery" почтового ящика найденных сообщений в PST-файл используются следующие параметры.

  - **Почтовый ящик**   Почтовый ящик найденных сообщений

  - **Исходная папка**   Восстановленные для April Stewart

  - **ContentFilter**   Планы командировок в апреле

  - **Путь к файлу PST**   \\\\MYSERVER\\HelpDeskPst\\AprilStewartRecovery.pst

<!-- end list -->

    New-MailboxExportRequest -Mailbox "Discovery Search Mailbox" -SourceRootFolder "April Stewart Recovery" -ContentFilter {Subject -eq "April travel plans"} -FilePath \\MYSERVER\HelpDeskPst\AprilStewartRecovery.pst

Дополнительные сведения о синтаксисе и параметрах см. в разделе [New-MailboxExportRequest](https://technet.microsoft.com/ru-ru/library/ff607299\(v=exchg.150\)).

В этом примере для импорта сообщений из файла PST в папку «Восстановленные службой технической поддержки» в почтовом ящике пользователя April Stewart используются следующие параметры.

  - **Почтовый ящик**   April Stewart

  - **Целевая папка**   Восстановленные службой технической поддержки

  - **Путь к файлу PST**   \\\\MYSERVER\\HelpDeskPst\\AprilStewartRecovery.pst

<!-- end list -->

    New-MailboxImportRequest -Mailbox "April Stewart" -TargetRootFolder "Recovered By Helpdesk" -FilePath \\MYSERVER\HelpDeskPst\AprilStewartRecovery.pst 

Дополнительные сведения о синтаксисе и параметрах см. в разделе [New-MailboxImportRequest](https://technet.microsoft.com/ru-ru/library/ff607310\(v=exchg.150\)).

**Как проверить, что все получилось?**

Чтобы убедиться в том, что вы успешно экспортировали сообщения в PST-файл используйте Outlook для открытия PST-файла и проверьте его содержимое. Чтобы убедиться в том, что вы успешно импортировали сообщения из PST-файла, пользователю необходимо осмотреть содержимое указанной папки назначения в команде, приведенной выше.

## Дополнительные сведения

  - Возможность восстановления удаленных элементов включается функцией *восстановления одного элемента*. Она позволяет администратору восстановить сообщение, которое было окончательно удалено пользователем или политикой хранения, пока не истек срок хранения удаленных элементов для этого элемента. Дополнительные сведения о восстановлении отдельных элементов см. в статье [Папка "Элементы для восстановления"](recoverable-items-folder-exchange-2013-help.md).

  - По умолчанию почтовый ящик Exchange Online настроен таким образом, чтобы хранить удаленные элементы в течение 14 дней. Этот параметр можно изменить до максимального значения 30 дней. В Exchange 2013 база данных почтовых ящиков настроена таким образом, чтобы по умолчанию хранить удаленные элементы в течение 14 дней. Вы можете настроить параметры хранения удаленных элементов для почтового ящика или базы данных почтовых ящиков. Дополнительные сведения см. в следующих разделах:
    
      - [Изменение срока хранения окончательно удаленных элементов для почтового ящика Exchange Online](https://technet.microsoft.com/ru-ru/library/dn163584\(v=exchg.150\))
    
      - [Настройка хранения удаленных элементов и квот элементов для восстановления](configure-deleted-item-retention-and-recoverable-items-quotas-exchange-2013-help.md)

  - Как упоминалось ранее, вы также можете найти удаленные элементы и экспортировать их в PST-файл с помощью средства обнаружения электронных данных на месте. С помощью этого PST-файла пользователь может восстановить удаленные сообщения в своем почтовом ящике. Подробные указания см. в статье [Восстановление элементов, удаленных из почтового ящика пользователя: справка для администраторов](https://go.microsoft.com/fwlink/p/?linkid=722928).

  - Пользователи могут восстановить удаленный элемент, если он не был окончательно удален, и если срок хранения удаленных элементов для этого элемента не истек. Если пользователям требуется восстановить удаленные элементы из папки "Элементы с возможностью восстановления", рекомендуем ознакомиться со следующими статьями:
    
      - [Восстановление удаленных элементов в Outlook 2010](https://go.microsoft.com/fwlink/p/?linkid=524923)
    
      - [Восстановление удаленных элементов в Outlook 2013](https://go.microsoft.com/fwlink/p/?linkid=624829)
    
      - [Восстановление удаленных элементов или электронной почты в Outlook Web App](https://go.microsoft.com/fwlink/p/?linkid=524924)

  - В этом разделе показано, как можно использовать командлет **Search-Mailbox** в командной консоли для поиска и восстановления отсутствующих элементов. С помощью него можно выполнять поиск только в одном почтовом ящике. Если вам требуется выполнить поиск в нескольких почтовых ящиках одновременно, вы можете использовать функцию [Обнаружение электронных данных на месте](in-place-ediscovery-exchange-2013-help.md) в Центре администрирования Exchange (EAC) или командлет [New-MailboxSearch](https://technet.microsoft.com/ru-ru/library/dd298064\(v=exchg.150\)) в Оболочка Windows PowerShell.

  - Помимо использования этой процедуры для поиска и восстановления удаленных элементов, вы также можете использовать аналогичную процедуру для поиска элементов в почтовых ящиках пользователей и последующего удаления найденных элементов из исходного почтового ящика. Дополнительные сведения см. в разделе [Поиск и удаление сообщений (справка администратора)](search-for-and-delete-messages-admin-help-exchange-2013-help.md).

