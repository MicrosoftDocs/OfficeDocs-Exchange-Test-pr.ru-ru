---
title: 'Диагностика неполадок службы поиска Exchange: Exchange 2013 Help'
TOCTitle: Диагностика неполадок службы поиска Exchange
ms:assetid: 8cfa26f4-ccf0-42dd-8570-67018188b4e8
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Bb123701(v=EXCHG.150)
ms:contentKeyID: 52061272
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Диагностика неполадок службы поиска Exchange

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2016-12-09_

Служба поиска Exchange индексирует почтовые ящики и поддерживаемые вложения в почтовых ящиках Exchange. Из-за роста объема сообщений электронной почты, увеличения размера почтовых ящиков и квот хранения, подготовки архивных почтовых ящиков для пользователей и внедрения обнаружения электронных данных на месте для выполнения поиска с обнаружением служба поиска Exchange становится важнейшим компонентом серверов почтовых ящиков в организации Microsoft Exchange Server 2013. Проблемы со службой поиска Exchange могут повлиять на производительность пользователей и работу службы обнаружения электронных данных на месте.

Дополнительные сведения о службе поиска Exchange см. в разделе [подсистема поиска Exchange](exchange-search-exchange-2013-help.md).

Необходимы задачи управления, связанные с управления службой поиска Exchange? См. раздел [Процедуры поиска в службе Exchange](exchange-search-procedures-exchange-2013-help.md).

## Использование командлета Test-ExchangeSearch

На этапе 5 процедуры, представленной в этом разделе, описывается выполнение командлета **Test-ExchangeSearch** для диагностики проблем со службой поиска Exchange. С помощью командлета **Test-ExchangeSearch** можно тестировать функции службы поиска Exchange для сервера почтовых ящиков, базы данных почтовых ящиков или определенного почтового ящика. Командлет доставляет тестовое сообщение в указанный почтовый ящик (или системный почтовый ящик базы данных, если почтовый ящик не указан), а затем выполняет поиск, чтобы определить, индексировано ли сообщение, и узнать время, потребовавшееся для индексации. В нормальных условиях служба поиска Exchange индексирует сообщение в течение около 10 секунд после создания сообщения или его доставки в почтовый ящик. Тестовое сообщение автоматически удаляется после проверки.

Дополнительные сведения о синтаксисе и параметрах см. в разделе [Test-ExchangeSearch](https://technet.microsoft.com/ru-ru/library/bb124733\(v=exchg.150\)).

## Получение элементов, не поддерживающих поиск

С помощью командлета [Get-FailedContentIndexDocuments](https://technet.microsoft.com/ru-ru/library/dd351154\(v=exchg.150\)) можно получить список элементов почтовых ящиков, недоступных для поиска, которые не были успешно индексированы службой поиска Exchange. Этот командлет можно запустить на сервере почтовых ящиков, в базе данных почтовых ящиков или в определенном почтовом ящике. Командлет возвращает сведения о каждом элементе, поиск которого не удалось выполнить. Поиск элемента почтового ящика может быть невозможен по нескольким причинам. Например, сообщение электронной почты может содержать тип файла вложения, который не может быть проиндексирован для поиска. Также фильтр поиска может быть не установлен или отключен. Если фильтр поиска для такого типа файлов доступен, вы можете установить его на серверы exExchangeNoVersionExchange.

> [!IMPORTANT]  
> Корпорация Майкрософт проверяет и поддерживает фильтры, которые предоставляет сама. Мы рекомендуем проверить сторонние фильтры поиска в тестовой среде перед их установкой на серверах exExchangeNoVersionExchange в производственной среде.


Дополнительные сведения об элементах, не включаемых в поиск, см. в разделе

  - [Форматы файлов, индексируемые службой поиска Exchange](file-formats-indexed-by-exchange-search-exchange-2013-help.md)

  - [Элементы, которые не включены в поиск при обнаружении электронных данных Exchange](unsearchable-items-in-exchange-ediscovery-exchange-2013-help.md)

## Диагностика неполадок службы поиска Exchange

Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Подраздел "Служба поиска Exchange" в разделе [Разрешения получателей](recipients-permissions-exchange-2013-help.md).

1.  **Проверка состояния службы**. Запущена ли служба поиска Microsoft Exchange (MSExchangeFastSearch) на сервере почтовых ящиков? Если да, перейдите к действию 2. Если нет, воспользуйтесь оснасткой "Службы" консоли MMC, чтобы убедиться, что служба MSExchangeSearch запущена:
    
    1.  Нажмите кнопку **Пуск**, выберите пункт **Администрирование** и выберите **Службы**.
    
    2.  В разделе **Службы** убедитесь, что **состояние** службы **поиска Microsoft Exchange** указано как **Запущено**.

2.  **Проверка конфигурации базы данных почтовых ящиков**   Присвоено ли параметру *IndexEnabled* значение True для базы данных почтовых ящиков пользователя? Если да, перейдите к шагу 3. Если нет, выполните следующую команду в командной консоли Exchange, чтобы убедиться, что для отметки *IndexEnabled* установлено значение True.
    
    ```powershell
Get-MailboxDatabase | Format-Table Name,IndexEnabled
```
    
    Подробные сведения о синтаксисе и параметрах см. в разделе [Get-MailboxDatabase](https://technet.microsoft.com/ru-ru/library/bb124924\(v=exchg.150\)).

3.  **Проверьте состояние обхода базы данных почтовых ящиков**. Выполнен ли обход базы данных Exchange? Если да, перейдите к действию 4. Если нет, используйте монитор стабильности и производительности, чтобы проверить счетчик **Программа-обходчик: осталось почтовых ящиков** объекта производительности **Индексы поиска MSExchange**. Выполните следующие шаги.
    
    1.  Откройте **Системный монитор** (perfmon.exe).
    
    2.  В дереве консоли в разделе **Средства наблюдения** выберите **Системный монитор**.
    
    3.  На панели системного монитора нажмите кнопку **Добавить** (зеленый знак «плюс»).
    
    4.  В окне **Добавить счетчики** в списке **Выбрать счетчики с компьютера** выберите сервер, на котором размещена база данных почтовых ящиков, которую необходимо отслеживать.
    
    5.  В поле без метки под списком **Выбрать счетчики с компьютера** выберите объект производительности **Индексы поиска MSExchange**.
    
    6.  В поле **Экземпляры выбранного объекта** выберите экземпляр базы данных почтовых ящиков пользователя.
    
    7.  Нажмите кнопку **Добавить**, а затем кнопку **ОК**.
        
        В области монитора производительности объект производительности **Индексы поиска MSExchange** показан в столбце **Объект**, а его счетчики производительности — в столбце **Счетчик**.
    
    8.  Посмотрите на счетчик **Программа-обходчик: осталось почтовых ящиков**. Любое значение, которое равно или больше 1, указывает, что обход почтовых ящиков в базе данных по-прежнему выполняется. Если сканирование завершено, значение равно **0**.
    
    Сведения об использовании монитора производительности см. в разделе [Пошаговое руководство по отслеживанию производительности и стабильности в Windows Server 2008](https://go.microsoft.com/fwlink/p/?linkid=178005)

4.  **Проверка работоспособности индексирования копии базы данных**   Работоспособен ли индекс содержимого? Используйте командлет **Get-MailboxDatabaseCopyStatus** для проверки работоспособности индексирования содержимого для копии базы данных.
    
        Get-MailboxDatabaseCopyStatus -Server $env:ComputerName | Format-Table Name,Status,ContentIndex* -Auto
    
    Дополнительные сведения о синтаксисе и параметрах см. в разделе [Get-MailboxDatabaseCopyStatus](https://technet.microsoft.com/ru-ru/library/dd298044\(v=exchg.150\)).

5.  **Запуск командлета Test-ExchangeSearch**   Если база данных почтовых ящиков уже отсканирована, можно запустить командлет **Test-ExchangeSearch** для базы данных почтовых ящиков или для определенного почтового ящика.
    
    ```powershell
Test-ExchangeSearch -Identity AlanBrewer@contoso.com
```
    
    Дополнительные сведения о синтаксисе и параметрах см. в разделе [Test-ExchangeSearch](https://technet.microsoft.com/ru-ru/library/bb124733\(v=exchg.150\)).

6.  **Проверка журнала событий приложений**   Проверка журнала событий приложений на наличие сообщений об ошибках, связанных с поиском, с помощью средства просмотра событий или командной консоли Exchange. Проверьте наличие следующих источников событий.
    
      - **MSExchangeFastSearch**
    
      - **MSExchangeIS**
    
    Дополнительные сведения см. по ссылке, приведенной в записи журнала событий.

7.  **Перезапустите службу поиска Microsoft Exchange**. Используйте оснастку "Службы" консоли управления или командной консоли, чтобы остановить и перезапустить службу поиска МайкрософтExchange (MSExchangeFastSearch):
    
    1.  Нажмите кнопку **Пуск**, разверните меню **Администрирование** и выберите команду **Службы**.
    
    2.  В области **Службы** щелкните правой кнопкой мыши службу **Служба поиска Exchange** и нажмите кнопку **Остановить**. После остановки службы повторно щелкните службу правой кнопкой мыши и выберите команду **Запустить**.

8.  **Повторное заполнение каталога поиска**   В некоторых случаях, например при повреждении каталога поиска, может потребоваться повторно заполнить каталог. Если каталог поиск необходимо повторно заполнить, служба поиска Exchange уведомит вас, записав в журнал событий приложений соответствующие записи. Дополнительные сведения о повторном заполнении каталога поиска см. в разделе [Повторное заполнение каталога поиска](reseed-the-search-catalog-exchange-2013-help.md).

