---
title: 'Высокая доступность и устойчивость сайтов: Exchange 2013 Help'
TOCTitle: Высокая доступность и устойчивость сайтов
ms:assetid: 6628285e-d07c-443d-866b-be784ad1ed1e
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Dd638137(v=EXCHG.150)
ms:contentKeyID: 50488171
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Высокая доступность и устойчивость сайтов

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2016-12-15_

Можно защитить базы данных почтовых ящиков Exchange Server 2013 и содержащиеся в них данные, настроив для серверов и баз данных почтовых ящиков высокую доступность и устойчивость к сбоям. Exchange 2013 минимизирует стоимость и сложность развертывания решения по обмену сообщениями с функциями высокой доступности и устойчивости к сбоям, а также обеспечивает повышенную доступность данных и служб и поддержку крупных почтовых ящиков.

Exchange 2013 позволяет предприятиям любого размера и в любой отрасли выполнять экономичное развертывание службы непрерывного обмена сообщениями в организации на основе функций репликации и высокодоступной архитектуры в Exchange 2010. Список изменений в Exchange 2010 и Exchange 2007 см. в разделе [Изменение высокой доступности и устойчивости сайтов по сравнению с предыдущими версиями](changes-to-high-availability-and-site-resilience-over-previous-versions-exchange-2013-help.md).

**Содержание**

Основные термины

Группы обеспечения доступности баз данных

Копии базы данных почтовых ящиков

Активный диспетчер

Устойчивость сайта к сбоям

сторонний интерфейс API репликации

Документация высоким уровнем доступности и устойчивости сайта

## Основные термины

Следующие ключевые понятия важно понимать высокой доступности и устойчивости сайта:

  - *Активный диспетчер*  
    Внутренний компонент Exchange, который запускается в службе репликации Microsoft Exchange и отвечает за мониторинг сбоев и действие по исправлению путем отработки отказа в группе обеспечения доступности баз данных.

<!-- end list -->

  - *AutoDatabaseMountDial*  
    Значение свойства сервера почтовых ящиков, которое определяет, будет ли Копия пассивной базы данных будут автоматически подключены в качестве новой активной копии, в зависимости от количества файлов журнала, отсутствует копия быть подключен.

<!-- end list -->

  - *Непрерывная репликация — режим блокировки*  
    В режиме блокировки при каждой записи обновления в буфер активного журнала активной копии базы данных обновление также передается в буфер журнала каждой пассивной копии почтового ящика. После заполнения буфера журнала каждая копия базы данных строит, проверяет и создает следующий файл журнала по порядку номера версии.

<!-- end list -->

  - *Непрерывная репликация — режим файла*  
    В файловом режиме, закрытые файлы журнала транзакций переносятся из активной копии базы данных в одну или несколько пассивных копий базы данных.

<!-- end list -->

  - *Группа доступности базы данных*  
    Группа, содержащая до 16 серверов почтовых ящиков Exchange 2013, в которой размещается набор реплицированных баз данных.

<!-- end list -->

  - *Мобильность баз данных*  
    Способность отдельной базы данных почтовых ящиков Exchange 2013 к репликации и подключению на других серверах почтовых ящиков Exchange 2013.

<!-- end list -->

  - *Центр данных*  
    Обычно это относится к расположению Active Directory. Однако это также может относиться к физическому расположению. В контексте этой документации datacenter равно сайт Active Directory.

<!-- end list -->

  - *Режим координации активации центра данных*  
    Свойство параметра группы обеспечения доступности баз данных, при включении которого обеспечивается получение службой репликации Microsoft Exchange разрешения на подключение баз данных при запуске.

<!-- end list -->

  - *Аварийное восстановление*  
    Любой процесс, используемый для ручного восстановления после сбоя. Это может быть сбой, затрагивающий как отдельный объект, так и все физическое расположение.

<!-- end list -->

  - *Интерфейс API Exchange для сторонней репликации*  
    Представленный в Exchange интерфейс API, который позволяет использовать для группы обеспечения доступности баз данных стороннюю синхронную репликацию вместо непрерывной.

<!-- end list -->

  - *Высокая доступность*  
    Решение, которое обеспечивает доступность служб и данных, а также автоматическое восстановление после сбоев, затрагивающих службы или данные (например, сбой сети, хранилища или сервера).

<!-- end list -->

  - *Добавочное развертывание*  
    Возможность развертывания функций высокой доступности и устойчивости к сбоям после установки Exchange 2013.

<!-- end list -->

  - *Изолированная копия базы данных почтовых ящиков*  
    Пассивная копия базы данных почтовых ящиков, у которой время запаздывания преобразования журнала больше нуля.

<!-- end list -->

  - *Копия базы данных почтовых ящиков*  
    База данных почтовых ящиков (файл EDB и журналы), которая находится в активном или пассивном состоянии.

<!-- end list -->

  - *Устойчивость почтовых ящиков*  
    Название объединенного решения по обеспечению высокой доступности и устойчивости к сбоям в Exchange 2013.

<!-- end list -->

  - *Управляемая доступность*  
    Набор внутренних процессов, который состоит из зондов, мониторов и отвечающих устройств, обеспечивающих мониторинг и высокую доступность для всех ролей сервера и протоколов.

<!-- end list -->

  - *\*over* (произносится "звездочка over")  
    Сокращение от терминов *переключение* (switchover) и *отработка отказа* (failover). Переключение представляет собой ручную активацию одной или нескольких копий базы данных. Отработка отказа представляет собой автоматическую активацию одной или нескольких копий базы данных после сбоя.

<!-- end list -->

  - *Система безопасности*  
    Компонент службы транспорта, ранее называвшийся транспортной корзиной, в котором хранится копия всех сообщений в течение *X* дн. Значение по умолчанию: 2 дня.

<!-- end list -->

  - *теневая избыточность*  
    Функция транспортного сервера, обеспечивающая избыточность для сообщений на всем протяжении их пересылки.

<!-- end list -->

  - *Устойчивость сайта к сбоям*  
    Конфигурацию, которая расширяет инфраструктуру обмена сообщениями на несколько сайтов Active Directory, чтобы обеспечить бесперебойное функционирование для системы обмена сообщениями в случае сбоя, затрагивающего один из сайтов.

К началу страницы

## Группы обеспечения доступности баз данных

Группа обеспечения доступности баз данных является базовым компонентом платформы высокой доступности и устойчивости к сбоям, встроенной в Exchange 2013. Группа обеспечения доступности баз данных — это группа серверов почтовых ящиков (до 16 серверов), которые содержат набор баз данных и обеспечивают автоматическое восстановление на уровне базы данных после сбоя, затрагивающего отдельные серверы и базы данных. На любом сервере в группе обеспечения доступности баз данных можно разместить копию базы данных почтовых ящиков с любого другого сервера в группе обеспечения доступности баз данных. Если сервер добавлен в группу обеспечения доступности баз данных, он вместе с другими серверами в этой группе обеспечивает автоматическое восстановление после сбоев, затрагивающих базы данных почтовых ящиков, например сбоев дисков или серверов. Дополнительные сведения о группах обеспечения доступности баз данных см. в разделе [Группы обеспечения доступности баз данных](database-availability-groups-dags-exchange-2013-help.md).

К началу страницы

## Копии базы данных почтовых ящиков

Высокий уровень доступности и устойчивость сайта компонентов, выпущенного в Exchange 2010 используются в Exchange 2013 для создания и поддержания копий баз данных. Exchange 2013 также используется концепция мобильности базы данных, которая является Exchange-управляемый отработки отказов на уровне базы данных.

Функция мобильности базы данных обеспечивает отключение баз данных от серверов и добавление поддержки до 16 копий одной базы данных. Она также отвечает за взаимодействие при создании копий базы данных.

Настройка копии базы данных в качестве активной базы данных почтовых ящиков называется *переключением*. Ситуация, когда происходит сбой, затрагивающий базу данных, а новая база данных становится активной копией, называется *отработкой отказа*. Этот процесс также затрагивает сбой сервера, при котором один или несколько серверов переводят в оперативный режим базы данных, которые ранее находились на неисправном сервере. Когда происходит переключение или отработка отказа, другие роли сервера Exchange 2013 оповещаются об этом практически немедленно и перенаправляют клиентский трафик и трафик обмена сообщениями к новой активной базе данных.

Например, если происходит сбой активной базы данных в группе обеспечения доступности баз данных из-за сбоя соответствующего хранилища, активный диспетчер выполняет автоматическое восстановление, переходя на копию базы данных на другом сервере почтовых ящиков в группе обеспечения доступности баз данных. В Exchange 2013 управляемая доступность обеспечивает добавление новых реакций на события для восстановления доступа к базе данных по протоколу, в том числе перезапуск рабочих пулов приложений, служб и серверов, а также введение отработки отказов в базах данных.

Дополнительные сведения о копиях баз данных почтовых ящиков см. в разделе [Копии базы данных почтовых ящиков](mailbox-database-copies-exchange-2013-help.md).

К началу страницы

## Активный диспетчер

Exchange 2013 использует активный диспетчер, появившийся в Exchange 2010, для управления работоспособностью, состоянием, непрерывной репликацией и другими аспектами баз данных и копий базы данных для обеспечения высокой доступности сервера почтовых ящиков. Дополнительные сведения об активном диспетчере см. в разделе [Активный диспетчер](active-manager-exchange-2013-help.md).

К началу страницы

## Устойчивость сайта к сбоям

Хотя в Exchange 2013 и дальше используются группы обеспечения доступности баз данных и отказоустойчивая кластеризация Windows для обеспечения высокой доступности роли сервера почтовых ящиков и устойчивости сайта, устойчивость сайта не одинакова в Exchange 2013. Устойчивость сайта находится гораздо лучше, так как он был в Exchange 2013 упрощенная. Базовые архитектурные изменения, которые были сделаны в Exchange 2013 восстановление значительно повлиять на аспекты конфигурации устойчивости сайтов.

В Exchange 2010 восстановление серверов почтовых ящиков (группа обеспечения доступности баз данных) и клиентского доступа (массив серверов клиентского доступа) были связаны друг с другом. В случае потери всех серверов клиентского доступа, важного компонента массива или значительной части группы обеспечения доступности баз данных требовалось выполнить переключение центра данных. Это хорошо задокументированный и, как правило, понятный процесс, хотя и занимает много времени, а также требует вмешательства человека для его запуска.

В Exchange 2013 при потере массива серверов клиентского доступа по каким-либо причинам (например, вследствие сбоя подсистемы балансировки нагрузки) не нужно выполнять переключение центра данных. При правильной настройке переключение происходит на уровне клиента, а клиенты автоматически перенаправляются на второй центр данных с работающими серверами клиентского доступа. Эти серверы клиентского доступа по прокси-соединению передают данные обратно на сервер почтовых ящиков пользователя, на который не повлиял сбой (поскольку не выполняется переключение). Выполняется автоматическое восстановление службы, и пользователь может сосредоточиться на решении основной проблемы (например, замене вышедшей из строя подсистемы балансировки нагрузки).

Кроме того, благодаря упрощению пространства имен, консолидации ролей сервера, разъединению требований к роли сервера сайта Active Directory, разделению массива серверов клиентского доступа, восстановлению группы обеспечения доступности баз данных и изменению подсистемы балансировки нагрузки в Exchange 2013 внесены изменения, которые обеспечивают раздельное, автоматическое восстановление сервера клиентского доступа и группы обеспечения доступности баз данных на всех сайтах, что делает доступными сценарии отработки отказа центра данных при наличии трех расположений.

В Exchange 2010 можно было развернуть группу обеспечения доступности баз данных в двух центрах обработки данных, в третьем разместить следящий сервер и включить отработку отказа для роли сервера почтовых ящиков в каждом центре обработки данных. При этом отработка отказа не выполнялась для самого решения, поскольку требовалось вручную изменить пространство имен для ролей сервера, отличных от роли сервера почтовых ящиков.

В Exchange 2013 пространство имен не нужно перемещать с группой обеспечения доступности баз данных. отказоустойчивость рычаги Exchange встроенные в пространство имен через несколько IP-адресов, распределения нагрузки (и в случае необходимости, возможность использования серверов и исходящая служба). Современные клиенты HTTP автоматически работают с такой избыточностью. Стек HTTP способен принять несколько IP-адресов для полного доменного имени. При устойчивом отказе первого IP-адреса (то есть невозможности подключения) используется следующий IP-адрес в списке. При "мягком" отказе (потере соединения после установки сеанса, возможно, вследствие прерывистого сбоя службы, например, если устройство сбрасывает пакеты и нуждается в снятии с эксплуатации) может понадобиться обновить браузер.

Это означает, что пространство имен больше не является единой точкой отказа, как в Exchange 2010. В Exchange 2010, пожалуй, основная критической точки отказа системы обмена сообщениями-это полное доменное имя, которое вы даете пользователям, поскольку это говорит пользователь куда идти. В парадигме Exchange 2010 изменить полное доменное имя для обозначения адресата не так просто, поскольку необходимо изменить DNS, а затем обработать задержки DNS, что иногда является трудной задачей. Кроме того, также в обработке нуждаются кэши имен в браузерах, что обычно занимает около 30 минут или более.

Одно из изменений в Exchange 2013 состояло в том, чтобы клиенты имели несколько пунктов назначения. Предположим, что для клиента можно использовать несколько пунктов назначения (в основе почти всех протоколов клиентского доступа в Exchange 2013 лежит HTTP (примеры — Outlook, мобильный Outlook, EAS, EWS, OWA и Центр администрирования Exchange), а все поддерживаемые клиенты HTTP могут использовать несколько IP-адресов), что обеспечивает отработку отказа на стороне клиента. Можно настроить DNS, чтобы рука нескольких IP-адресов на клиенте во время разрешения имен. Клиент запрашивает почту Contoso.com и вернется. два IP-адреса, или четырех IP-адресов, например. Однако клиент получает много IP-адресов будет надежно использоваться назад клиенту. Это значительно улучшает возможности клиента, поскольку при сбое одного IP-адреса клиент может выполнить попытку подключения по другим адресам. При сбое одного из адресов клиент ожидает в течение 20 секунд, а затем выполняет попытку подключения по следующему адресу в списке. Таким образом, при потере важного компонента массива серверов клиентского доступа в течение около 21 секунды выполняется автоматическое восстановление клиентов.

Ниже перечислены связанные с этим преимущества.

  - В Exchange 2010 при потере подсистемы балансировки нагрузки в главном центре обработки данных (и при этом на данном сайте отсутствовала другая подсистема) приходилось выполнять переключение центра обработки данных. В Exchange 2013 при потере подсистемы балансировки нагрузки на главном сайте ее (или, возможно, важный компонент) просто необходимо отключить, а затем отремонтировать или заменить. В клиентах, в которых уже не используется важный компонент в дополнительном центре обработки данных, будет выполнена автоматическая отработка отказа на дополнительный важный компонент без изменения пространства имен и DNS. Благодаря этому не только отпадает необходимость в переключении, но и экономится время, которое обычно тратится на переключение центра обработки данных. В Exchange 2010 приходилось обрабатывать задержку DNS (поэтому рекомендовалось установить срок жизни (TTL) в 5 минут, а также ввести URL-адрес для обработки отказа). В Exchange 2013 эти операции не требуются благодаря быстрой обработке отказа (20 секунд) пространства имен между важными компонентами (центрами обработки данных).

  - Благодаря быстрой обработке пространства имен между центрами обработки данных все, что требуется для обработки отказа центра обработки данных, — механизм обработки отказа роли сервера почтовых ящиков в центрах обработки данных. Для автоматической обработки отказа для группы обеспечения доступности баз данных необходимо просто разработать решение, при котором группа равномерно распределяется между двумя центрами обработки данных, а затем разместить следящий сервер в третьем расположении для его арбитража членами группы обеспечения доступности баз данных в каждом центре обработки данных (вне зависимости от состояния сети между центрами обработки данных с членами этой группы). Если при наличии только двух центров обработки данных третье физическое расположение недоступно, можно разместить следящий сервер на виртуальной машине Microsoft Azure. Дополнительные сведения см. в разделе [Использование виртуальной машины Microsoft Azure в качестве следящего сервера DAG](using-a-microsoft-azure-vm-as-a-dag-witness-server-exchange-2013-help.md).

  - В этом сценарии администратор пытается просто решить проблему, а не восстановить службу. При этом просто ошибка просто исправляется; служба продолжает работать, и сохраняется целостность данных. При восстановлении службы вы ощущаете намного меньшие стресс и нехватку времени, чем при ремонте неисправного устройства. Работа пользователя и администратора значительно упрощается.

Вы можете разрешить выполнение отработки отказа без необходимости обратного подключения (иногда ошибочно зовется восстановлением размещения). Если вы потеряете серверы клиентского доступа в главном центре обработки данных, что приведет к 20-секундному перерыву в работе клиентов, можно даже не заботиться о восстановлении после сбоя. На данный момент основная задача состоит в решении ключевой проблемы (например, замене вышедшей из строя подсистемы балансировки нагрузки). После того как она подключится к сети и продолжит работу, одни клиенты начнут ее использование, а другие будут функционировать через второй центр обработки данных.

Exchange 2013 также обеспечивает функциональность, позволяет администраторам разобраться с периодическим сбоям. Прерывистый сбой происходит, если, например, ничего не происходит после установки начального TCP-соединения. Непредвиденный сбой требует некоторой дополнительной административные взыскания, так как это может быть в результате ввода в эксплуатацию нового устройства. В ходе восстановления устройство может быть включено и принимать некоторые запросы, но оно фактически не готово к обслуживанию клиентов, пока не будут выполнены необходимые действия по настройке. В этом сценарии, администратор может выполнять пространства имен, просто удалив VIP переключение для заменяемого устройства от DNS. Затем в течение этого периода, нет клиентов будут пытаться подключиться к нему. После замены администратор может добавить важный компонент обратно в DNS, а клиенты в конечном итоге начнут использовать его.

Дополнительные сведения о планировании и развертывании см. в разделе [Планирование высокой доступности и устойчивости сайтов](planning-for-high-availability-and-site-resilience-exchange-2013-help.md) или [Развертывание с высоким уровнем доступности и устойчивости сайта](deploying-high-availability-and-site-resilience-exchange-2013-help.md).

К началу страницы

## сторонний интерфейс API репликации

Система Exchange 2013 также включает в себя новый сторонний интерфейс API репликации, позволяющий организациям использовать сторонние решения по синхронной репликации вместо функции встроенной непрерывной репликации. Корпорация Майкрософт поддерживает решения сторонних производителей, использующие этот интерфейс API, если решение содержит необходимые функции, заменяющие все встроенные функции непрерывной репликации, которые отключены из-за использования интерфейса API. Поддержка решений обеспечивается, только когда интерфейс API используется в группе обеспечения доступности баз данных для управления и активации копий базы данных почтовых ящиков. Использование интерфейса API для других целей не поддерживается. Кроме того, решение должно удовлетворять соответствующие требования к поддержке оборудования Windows. (Для поддержки не требуется тестовая проверка)

При развертывании решения, использующего встроенный API репликации от сторонних производителей, учтите, что поставщик этого решения несет ответственность за основную его поддержку. Корпорация Майкрософт поддерживает данные Exchange для решений с репликацией и без нее. Решения, использующие репликацию данных, должны соответствовать политике Майкрософт, касающейся поддержки репликации данных. Эта политика указана в статье [Поддержка репликации данных в нескольких сайтах для Exchange Server](https://go.microsoft.com/fwlink/p/?linkid=3052&kbid=895847) (статье 895847 из базы знаний Майкрософт). Кроме того, решения, использующие модель ресурсов Windows Failover Cluster, должны отвечать требованиям, касающимся поддержки кластеров Windows. Эти требования можно найти в статье 943984 из базы знаний Майкрософт, [Политика Майкрософт в отношении поддержки отказоустойчивых кластеров для Windows Server 2008 и Windows Server 2008 R2](https://go.microsoft.com/fwlink/p/?linkid=3052&kbid=943984) или [Политика Майкрософт в отношении поддержки отказоустойчивых кластеров для Windows Server 2012](https://go.microsoft.com/fwlink/p/?linkid=3052&kbid=2775067).

Политика Майкрософт в области поддержки резервного копирования и восстановления для развертываний, использующих решения по репликации на основе интерфейсов API сторонних производителей, аналогична политике для развертываний со встроенной непрерывной репликацией.

Партнеры корпорации Майкрософт могут получить сведения о стороннем интерфейсе API в любом местном представительстве.

К началу страницы

## Документация высоким уровнем доступности и устойчивости сайта

В следующей таблице приведены ссылки на разделы, помогающие ознакомиться и управлять группами доступности баз данных, копии баз данных почтовых ящиков, и для резервного копирования и восстановления для Exchange 2013.


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Раздел</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><a href="database-availability-groups-dags-exchange-2013-help.md">Группы обеспечения доступности баз данных</a></p></td>
<td><p>Сведения о группах DAG, активном диспетчере, режиме DAC и копиях базы данных почтовых ящиков.</p></td>
</tr>
<tr class="even">
<td><p><a href="planning-for-high-availability-and-site-resilience-exchange-2013-help.md">Планирование высокой доступности и устойчивости сайтов</a></p></td>
<td><p>Сведения об общих требованиях, включая требования к оборудованию, сети, программному обеспечению, следящему серверу и другим компонентам, а также рекомендации для групп обеспечения доступности баз данных.</p></td>
</tr>
<tr class="odd">
<td><p><a href="deploying-high-availability-and-site-resilience-exchange-2013-help.md">Развертывание с высоким уровнем доступности и устойчивости сайта</a></p></td>
<td><p>Исследовать пример сценария развертывания для развертывания и настройки групп DAG.</p></td>
</tr>
<tr class="even">
<td><p><a href="managing-high-availability-and-site-resilience-exchange-2013-help.md">Управление высокой доступностью и устойчивостью сайтов</a></p></td>
<td><p>Подробнее о задачах управления DAG, переключениями и отработками отказа, и режим обслуживания.</p></td>
</tr>
<tr class="odd">
<td><p><a href="monitoring-database-availability-groups-exchange-2013-help.md">Наблюдение за группами обеспечения доступности баз данных</a></p></td>
<td><p>Описание встроенных командлетов и сценариев для группы доступности базы данных и копии базы данных наблюдения.</p></td>
</tr>
<tr class="even">
<td><p><a href="backup-restore-and-disaster-recovery-exchange-2013-help.md">Резервное копирование, восстановление и аварийное восстановление</a></p></td>
<td><p>Сведения о резервном копировании и восстановлении баз данных Exchange, восстановления базы данных, и восстановления серверов.</p></td>
</tr>
</tbody>
</table>


К началу страницы

