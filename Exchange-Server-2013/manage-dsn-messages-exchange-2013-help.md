---
title: 'Управление сообщениями DSN: Exchange 2013 Help'
TOCTitle: Управление сообщениями DSN
ms:assetid: 23c9d844-6fc7-44c9-a308-587338281611
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Aa996803(v=EXCHG.150)
ms:contentKeyID: 50487677
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
f1_keywords:
- изменение системного сообщения
- изменение сообщения об отклонении
- изменение сообщения отчета о недоставке
- изменение сообщения квоты
ms.translationtype: HT
---

# Управление сообщениями DSN

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2013-02-20_

Microsoft Exchange Server 2013 использует уведомления о доставке (DSN) для предоставления отправителям сообщений отчетов о недоставке (NDR) и других сообщений о состоянии. Вы можете использовать встроенные уведомления о доставке или создать настраиваемые уведомления в соответствии с потребностями вашей организации.

## Что нужно знать перед началом работы

  - Предполагаемое время для завершения: 15 минут.

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись "Уведомления о доставке" в разделе [Разрешения потока обработки почты](mail-flow-permissions-exchange-2013-help.md).

  - Нельзя удалить встроенное сообщение DSN, входящее в состав Exchange. Чтобы изменить встроенное сообщение DSN, необходимо создать новое настраиваемое сообщение DSN для кода DSN, который требуется настроить. При удалении настроенного сообщения DSN его соответствующий код заменяется исходным встроенным уведомлением о доставке, заданным в Exchange.

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

> [!TIP]  
> Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>.


## Что необходимо сделать?

## Использование командной консоли для просмотра встроенных и настраиваемых сообщений DSN

Чтобы просмотреть сводный список всех встроенных сообщений DSN в составе Exchange 2013, выполните следующую команду.

    Get-SystemMessage -Original

Чтобы просмотреть сводный список всех настраиваемых сообщений DSN в организации, выполните следующую команду.

    Get-SystemMessage

Чтобы просмотреть подробные сведения о настраиваемом сообщении DSN для кода 5.1.2, которое отправлено внутренним отправителям на английском языке, выполните следующую команду.

    Get-SystemMessage En\Internal\5.1.2 | Format-List

## Использование командной консоли для создания настраиваемого сообщения DSN

Выполните следующую команду:

    New-SystemMessage -Internal <$true | $false> -Language <Locale> -DSNCode <x.y.z> -Text "<DSN text>"

В этом примере показано создание настраиваемого сообщения DSN в виде простого текста для кода DSN 5.1.2, отправляемого внутренним отправителям на английском языке.

    New-SystemMessage -Internal $true -Language En -DSNCode 5.1.2 -Text "You tried to send a message to a disabled mailbox that's no longer accepting messages. Please contact the Help Desk at extension 123 for assistance."

В этом примере показано создание настраиваемого сообщения DSN в виде простого текста для кода DSN 5.1.2, отправляемого внешним отправителям на английском языке.

    New-SystemMessage -Internal $false -Language En -DSNCode 5.1.2 -Text "You tried to send a message to a disabled mailbox that's no longer accepting messages. Please contact your System Administrator for more information."

В этом примере показано создание настраиваемого HTML сообщения DSN в виде простого текста для кода DSN 5.1.2, отправляемого внутренним отправителям на английском языке.

    New-SystemMessage -DSNCode 5.1.2 -Internal $true -Language En -Text 'You tried to send a message to a <B>disabled</B> mailbox. Please visit <A HREF="http://it.contoso.com">Internal Support</A> or contact &quot;InfoSec&quot; for more information.'

## Как проверить, что все получилось?

Чтобы проверить, успешно ли создано настраиваемое сообщение DSN, выполните следующие действия.

1.  Выполните следующую команду:
    
        Get-SystemMessge -DSNCode <x.y.z> | Format-List Name,Internal,Text,Language

2.  Убедитесь, что отображаются настроенные значения.

3.  Отправьте тестовое сообщение, которое будет генерировать настраиваемые уведомления о доставке.

## Изменение текста настраиваемого уведомления о доставке с помощью командной консоли Exchange

Чтобы изменить текст настраиваемого сообщения DSN выполните следующую команду.

    Set-SystemMessage <Locale>\<Internal | External>\<DSNcode> -Text "<DSN text>"

В этом примере показано изменение текста, назначенного настраиваемому сообщению DSN для кода 5.1.2, отправляемого внутренним отправителям на английском языке.

    Set-SystemMessage En\Internal\5.1.2 -Text "The mailbox you tried to send an e-mail message to is disabled and is no longer accepting messages. Please contact the Help Desk at extension 123 for assistance."

## Как проверить, что все получилось?

Чтобы проверить, успешно ли изменен текст настраиваемого сообщения DSN, выполните следующие действия.

1.  Выполните следующую команду: `Get-SystemMessage`.
    
        Set-SystemMessage <Locale>\<Internal | External>\<DSNcode> | Format-List -Text

2.  Убедитесь, что отображается значение, которое вы настроили.

## Использование командной консоли для удаления настраиваемого сообщения DSN

Выполните следующую команду:

    Remove-SystemMessage <Local>\<Internal | External>\<DSNcode>

В этом примере показано удаление настраиваемого сообщения DSN для кода 5.1.2, отправляемого внутренним отправителям на английском языке.

    Remove-SystemMessage En\Internal\5.1.2

## Как проверить, что все получилось?

Чтобы проверить, успешно ли удалено настраиваемое сообщение DSN, выполните следующие действия.

1.  Выполните следующую команду: `Get-SystemMessage`.

2.  Убедитесь, что удаленное уведомление о доставке для языка, внутренних или внешних получателей и код уведомления о доставке не отображаются.

## Перенаправление копий сообщений DSN в почтовый ящик получателя Exchange

Можно создать список кодов DSN, которые нужно отслеживать, путем копирования сообщений DSN в почтовый ящик получателя Exchange. Однако по умолчанию получателю Exchange не назначено ни одного почтового ящика, поэтому все сообщения, отправленные получателю Exchange, отклоняются. Чтобы отправлять копии сообщений DSN в почтовый ящик получателя Exchange, необходимо назначить почтовый ящик получателю Exchange, а затем указать конкретные коды уведомления о доставке для отслеживания. По умолчанию отслеживаются следующие коды уведомления о доставке: `5.4.8`, `5.4.6`, `5.4.4`, `5.2.4`, `5.2.0` и `5.1.4`.

## Действие 1. Использование командной консоли для назначения почтового ящика получателю Exchange

Чтобы назначить почтовый ящик получателю Exchange, выполните следующие действия.

1.  В связи с большими объемами сообщений электронной почты рекомендуется создать выделенный почтовый ящик и учетную запись пользователя Active Directory для получателя Exchange. Подробнее см. в разделе [Создание почтовых ящиков пользователя](create-user-mailboxes-exchange-2013-help.md). Или определите существующий почтовый ящик, который нужно связать с получателем Exchange.

2.  Выполните следующую команду:
    
        Set-OrganizationConfig -MicrosoftExchangeRecipientReplyRecipient <MailboxIdentity>
    
    Например, чтобы назначить существующий почтовый ящик с именем "Системный почтовый ящик Contoso" получателю Exchange, выполните следующую команду.
    
        Set-OrganizationConfig -MicrosoftExchangeRecipientReplyRecipient "Contoso System Mailbox"

## Действие 2. Указание кодов уведомлений о доставке, которые нужно отслеживать

## Использование EAC для указания кодов уведомлений о доставке

1.  В EAC последовательно выберите **Поток почты** \> **Соединители получения** \> **Дополнительные параметры**![Значок дополнительных параметров](images/JJ150550.5381819e-3b21-4873-8714-e9b956290b28(EXCHG.150).gif "Значок дополнительных параметров") \> **Параметры транспорта организации** \> **Доставка**.

2.  В разделе **Коды уведомлений о доставке** введите коды, которые нужно отслеживать, в формате *\<x.y.z\>*, а затем нажмите кнопку **Добавить**![Значок добавления](images/JJ218640.c1e75329-d6d7-4073-a27d-498590bbb558(EXCHG.150).gif "Значок добавления"). Выберите существующую запись, а затем нажмите кнопку **Изменить**![Значок редактирования](images/Bb124582.6f53ccb2-1f13-4c02-bea0-30690e6ea71d(EXCHG.150).gif "Значок редактирования"), чтобы изменить ее, или **Удалить**![Значок "Удалить"](images/JJ657492.479b6ced-8d64-4277-a725-f17fea202b28(EXCHG.150).gif "Значок \"Удалить\""), чтобы удалить ее. Завершив настройку, нажмите кнопку **Сохранить**.

## Использование командной консоли для указания кодов уведомлений о доставке

Чтобы заменить существующие значения, выполните следующую команду:

    Set-TransportConfig -GenerateCopyOfDSNFor <x.y.z>,<x.y.z>...

В этом примере выполняется настройка организации Exchange для пересылки всех сообщений DSN с кодами 5.7.1, 5.7.2 и 5.7.3 получателю Exchange.

    Set-TransportConfig -GenerateCopyOfDSNFor 5.7.1,5.7.2,5.7.3

Чтобы добавить или удалить записи, не изменив существующие значения, выполните следующую команду:

    Set-TransportConfig -GenerateCopyOfDSNFor @{Add="<x.y.z>","<x.y.z>"...; Remove="<x.y.z>","<x.y.z>"...}

В этом примере показано добавление кода уведомлений о доставке 5.7.5 и удаление кода 5.7.1 из существующего списка сообщений DSN, которые перенаправляются получателю Exchange.

    Set-TransportConfig -GenerateCopyOfDSNFor @{Add="5.7.5"; Remove="5.7.1"}

## Как проверить, что все получилось?

Чтобы проверить успешную настройку копий сообщений DSN, которые будут отправлены в почтовый ящик получателя Exchange, обратите внимание на почтовый ящик, связанный с получателем Exchange, и убедитесь, что сообщения DSN содержат указанные коды.

