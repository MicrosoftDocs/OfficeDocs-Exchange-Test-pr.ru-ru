---
title: 'Восстановление данных с помощью базы данных восстановления: Exchange 2013 Help'
TOCTitle: Восстановление данных с помощью базы данных восстановления
ms:assetid: d64c18e7-16af-4bd8-a5c5-01206984d4d1
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Ee332351(v=EXCHG.150)
ms:contentKeyID: 50489156
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Восстановление данных с помощью базы данных восстановления

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2014-10-01_

База данных восстановления представляет собой специальный тип базы данных почтовых ящиков, который позволяет подключать восстановленную базу данных почтовых ящиков и извлекать данные из восстановленной базы данных в рамках операции восстановления. Базы данных восстановления позволяют выполнять аварийное восстановление данных из архива или копии базы данных без воздействия на пользовательский доступ к текущим данным.

После создания базы данных восстановления вы можете восстановить в нее базу данных почтовых ящиков, используя приложение резервного копирования или скопировав базу данных и ее файлы журналов в структуру папок базы данных восстановления. После этого можно воспользоваться командлетом [New-MailboxRestoreRequest](https://technet.microsoft.com/ru-ru/library/ff829875\(v=exchg.150\)) для извлечения данных из восстановленной базы данных. После извлечения данные можно экспортировать в папку или объединить с существующими данными почтового ящика.

Дополнительные сведения о задачах управления, связанных с базами данных восстановления (RDB), см. в статье [Базы данных восстановления](recovery-databases-exchange-2013-help.md).

## Что нужно знать перед началом работы

  - Предполагаемое время выполнения задачи: 1 минута плюс время на приведение базы данных в состояние чистого отключения и извлечение данных.

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись «Восстановление почтового ящика» в разделе [Разрешения получателей](recipients-permissions-exchange-2013-help.md).

  - Некоторые приложения резервного копирования позволяют восстановить данные Exchange непосредственно в базу данных восстановления. Система архивации данных Windows Server может восстанавливать в базу данных восстановления только резервные копии на уровне файлов. Она не может использоваться для восстановления резервных копий на уровне приложения в базу данных восстановления.

  - Базу данных и файлы журнала, содержащие восстановленные данные, необходимо восстановить или скопировать в структуру папок базы данных восстановления.

  - База данных должна находиться в состоянии чистого отключения. Поскольку база данных восстановления представляет собой альтернативное расположение восстановления для всех баз данных, все восстановленные базы данных будут находиться в состоянии неправильного отключения. Для переключения восстановленных баз данных в состояние чистого отключения следует использовать команду **Eseutil /R**.

## Использование командной консоли для восстановления данных с помощью базы данных восстановления

1.  Скопируйте восстановленную базу данных и ее файлы журнала или восстановите их в расположение, которое будет использоваться для базы данных восстановления.

2.  С помощью программы Eseutil переведите эту базу данных в состояние чистого отключения. В следующем примере EXX — это префикс создания журнала для базы данных (например, E00, E01, E02 и т. д.).
    
    ```powershell
Eseutil /R EXX /l <RDBLogFilePath> /d <RDBEdbFolder>
```
    
    В следующем примере показан префикс создания журнала E01 и путь базы данных восстановления и файла журнала E:\\Databases\\RDB1:
    
    ```powershell
Eseutil /R E01 /l E:\Databases\RDB1 /d E:\Databases\RDB1
```

3.  Создание базы данных восстановления Задайте для базы данных восстановления уникальное имя, но в параметре EdbFilePath введите имя и путь файла базы данных, а расположение восстановленных файлов журнала укажите в параметре LogFolderPath.
    
        New-MailboxDatabase -Recovery -Name <RDBName> -Server <ServerName> -EdbFilePath <RDBPathandFileName> -LogFolderPath <LogFilePath>
    
    В следующем примере показано создание базы данных восстановления, которая будет использоваться для восстановления базы данных DB1.edb и ее файлов журнала, расположенных в папке E:\\Databases\\RDB1.
    
        New-MailboxDatabase -Recovery -Name <RDBName> -Server <ServerName> -EdbFilePath "E:\Databases\RDB1\DB1.EDB" -LogFolderPath "E:\Databases\RDB1"

4.  Перезапустите службу банка данных Microsoft Exchange:
    
    ```powershell
Restart-Service MSExchangeIS
```

5.  Подключите базу данных:
    
    ```powershell
Mount-database <RDBName>
```

6.  Убедитесь, что подключенная база данных содержит почтовые ящики, которые вы хотите восстановить:
    
    ```powershell
Get-MailboxStatistics -Database <RDBName> | ft -auto
```

7.  С помощью командлета New-MailboxRestoreRequest восстановите почтовый ящик или элементы из базы данных восстановления в производственный почтовый ящик.
    
    В следующем примере показано восстановление исходного почтового ящика с идентификатором MailboxGUID 1d20855f-fd54-4681-98e6-e249f7326ddd из базы данных DB1 в целевом почтовом ящике с псевдонимом Morris.
    
        New-MailboxRestoreRequest -SourceDatabase DB1 -SourceStoreMailbox 1d20855f-fd54-4681-98e6-e249f7326ddd -TargetMailbox Morris
    
    В следующем примере показано восстановление содержимого исходного ящика с отображаемым именем Morris Cornejo из базы данных DB1 в архивном почтовом ящике для Morris@contoso.com.
    
        New-MaiboxRestoreRequest -SourceDatabase DB1 -SourceStoreMailbox "Morris Cornejo" -TargetMailbox Morris@contoso.com -TargetIsArchive

8.  Периодически проверяйте состояние запроса восстановления почтового ящика с помощью командлета [Get-MailboxRestoreRequest](https://technet.microsoft.com/ru-ru/library/ff829907\(v=exchg.150\)).
    
    Когда состояние восстановления изменится на "Завершено", уделите запрос, используя командлет [Remove-MailboxRestoreRequest](https://technet.microsoft.com/ru-ru/library/ff829910\(v=exchg.150\)). Например:
    
    ```powershell
Get-MailboxRestoreRequest -Status Completed | Remove-MailboxRestoreRequest
```

## Как проверить, что все получилось?

Чтобы убедиться, что вы успешно восстановили данные почтового ящика, откройте целевой почтовый ящик с помощью приложения Outlook или Outlook Web App и проверьте наличие восстановленных данных.

> [!TIP]  
> Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>.

