---
title: 'Exchange 2013: импорт перезаписей адресов на пограничных транспортных серверах'
TOCTitle: Импорт записей переопределения адресов на пограничных транспортных серверах
ms:assetid: bd0942c6-9c66-4b4c-b9bc-2f5f783def76
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Bb331966(v=EXCHG.150)
ms:contentKeyID: 61060573
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Импорт записей переопределения адресов на пограничных транспортных серверах

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2015-03-09_

С помощью файла данных с разделителями-запятыми (CSV) вы можете массово создавать или импортировать данные перезаписи адресов в пограничный транспортный сервер. В списке ниже представлено описание часто используемых сценариев, в соответствии с которыми необходимо выполнить следующие действия.

  - Замена решения перезаписи адреса с помощью пограничного транспортного сервера.

  - Заключение соглашения со сторонним поставщиком решений, по условиям которого вы должны выполнить переопределение своих адресов электронной почты.

  - Вы приобрели другую организацию и вам необходимо временно переопределить адреса электронной почты в приобретенной организации.

Чтобы создать CSV-файл, можно использовать любой текстовый редактор (например, Блокнот) или приложение, например Microsoft Excel. Отформатируйте файл, как описано в этом разделе, и сохраните его как CSV-файл.

В первой строке или *строке заголовков* CSV-файла перечисляются имена параметров. Параметры разделяются запятыми. Описание обязательных и дополнительных параметров представлено в таблице ниже.


<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Обязательный или дополнительный</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>Name</em></p></td>
<td><p>Обязательный</p></td>
<td><p>Уникальное, описательное имя записи для замены адреса.</p></td>
</tr>
<tr class="even">
<td><p><em>InternalAddress</em></p></td>
<td><p>Обязательный</p></td>
<td><p>Адрес, который требуется изменить. Можно использовать следующие значения.</p>
<ul>
<li><p>Отдельный адрес электронной почты (chris@contoso.com)</p></li>
<li><p>Отдельный домен или поддомен (contoso.com или sales.contoso.com)</p></li>
<li><p>Домен и все поддомены (*.contoso.com)</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><p><em>ExternalAddress</em></p></td>
<td><p>Обязательный</p></td>
<td><p>Желаемый адрес электронной почты. Можно использовать следующие значения.</p>
<ul>
<li><p>Отдельный адрес электронной почты, если он указан в параметре <em>InternalAddress</em>.</p></li>
<li><p>Отдельный домен или поддомен для всех других значений параметра <em>InternalAddress</em>.</p></li>
</ul></td>
</tr>
<tr class="even">
<td><p><em>ExceptionList</em></p></td>
<td><p>Необязательный</p></td>
<td><p>Доступен только при перезаписи адресов электронной почты в домене или всех поддоменах (*.contoso.com). Указывает одни или несколько поддоменов, которые требуется исключить из перезаписи адресов. Заключите значение в двойные кавычки и разделяйте отдельные значения запятыми. Например, <code>&quot;marketing.contoso.com&quot;</code> или <code>&quot;marketing.contoso.com,legal.contoso.com&quot;</code>.</p></td>
</tr>
<tr class="odd">
<td><p><em>OutboundOnly</em></p></td>
<td><p>Необязательный</p></td>
<td><p><code>False</code> означает, что адреса записаны на входящие и исходящие почтовые сообщения. <code>True</code> означает, что адреса перезаписаны только на исходящие почтовые сообщения, и необходимо вручную настроить перезаписанный адрес электронной почты в качестве адреса прокси-сервера для затронутых получателей.</p>
<p>По умолчанию задано значение <code>False</code>, однако необходимо установить значение <code>True</code>, если параметр <em>InternalAddress</em> содержит подстановочный знак (*.contoso.com).</p>
<p>Значение параметра <em>OutboundOnly</em> в CSV-файле — <code>True</code> или <code>False</code>, а не <code>$True</code> или <code>$False</code>.</p></td>
</tr>
</tbody>
</table>


Каждая строка под строкой заголовков представляет отдельную запись для замены адреса. Значения в каждой строке должны следовать в том же порядке, что и имена параметров в строке заголовков. Значения разделяются запятыми.

## Что нужно знать перед началом работы

  - Предполагаемое время выполнения задачи: 30 минут.

  - Необходимо правильно понимать последствия перезаписи адресов. Например, перезаписанный адрес электронной почты должен быть уникальным в вашей организации Exchange. Возможно, потребуется настроить адреса прокси-сервера для затронутых получателей. Дополнительные сведения см. в разделах [Переопределение адресов на пограничных транспортных серверах](address-rewriting-on-edge-transport-servers-exchange-2013-help.md) и [Управление переопределением адресов на пограничных транспортных серверах](manage-address-rewriting-on-edge-transport-servers-exchange-2013-help.md).

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Раздел "Агент переопределения адресов" статьи [Разрешения потока обработки почты](mail-flow-permissions-exchange-2013-help.md).

  - При наличии нескольких пограничных транспортных серверов мы рекомендуем выполнить указанные в этом разделе процедуры, чтобы импортировать записи переопределения адресов на один пограничный транспортный сервер, а затем клонировать конфигурацию этого пограничного транспортного сервера на другие пограничные транспортные серверы в организации. Дополнительные сведения о клонировании пограничного транспортного сервера см. в разделе [Клонированная конфигурация пограничного транспортного сервера](edge-transport-server-cloned-configuration-exchange-2013-help.md).

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

> [!TIP]  
> Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>.


## Как это сделать

## Шаг 1. Создайте CSV-файл.

После создания CSV-файла следует учесть перечисленные ниже моменты.

  - Если вы указываете значения для дополнительных параметров в CSV-файле, каждая строка должна включать значение в этом столбце. Если вы хотите создать несколько записей для замены адреса, где дополнительные параметры будут только у некоторых записей, вам необходимо разделить эти записи для замены адреса в два отдельных CSV-файла, а затем отдельно импортировать каждый CSV-файл.

  - Если CSV-файл содержит символы, не входящие в набор ASCII, сохраните его в кодировке UTF-8 или иной кодировке Юникода. В зависимости от приложения сохранить CSV-файл в кодировке UTF-8 или другой кодировке Юникода может оказаться проще, если язык системы соответствует языку, используемому в CSV-файле.

В следующем примере показано заполнение CSV-файла с помощью необязательных параметров *ExceptionList* и *OutboundOnly*.

    Name,InternalAddress,ExternalAddress,ExceptionList,OutboundOnly
    "Wingtip UK",*.wingtiptoys.co.uk,tailspintoys.com,"legal.wingtiptoys.co.uk,finance.wingtiptoys.co.uk,support.wingtiptoys.co.uk",True
    "Wingtip USA",*.wingtiptoys.com,tailspintoys.com,"legal.wingtiptoys.com,finance.wingtiptoys.com,support.wingtiptoys.com,corp.wingtiptoys.com",True
    "Wingtip Canada",*.wingtiptoys.ca,tailspintoys.com,"legal.wingtiptoys.ca,finance.wingtiptoys.ca,support.wingtiptoys.ca",True

## Шаг 2. Импортирование CSV-файла.

Чтобы импортировать CSV-файл, используйте следующий синтаксис.

    Import-Csv <FileNameAndPath> | ForEach {New-AddressRewriteEntry -Name $_.Name -InternalAddress $_.InternalAddress -ExternalAddress $_.ExternalAddress -OutboundOnly ([Bool]::Parse($_.OutboundOnly)) -ExceptionList $_.ExceptionList}

В этом примере показан импорт записей для замены адреса из папки C:\\My Documents\\ImportAddressRewriteEntries.csv.

    Import-Csv "C:\My Documents\ImportAddressRewriteEntries.csv" | ForEach {New-AddressRewriteEntry -Name $_.Name -InternalAddress $_.InternalAddress -ExternalAddress $_.ExternalAddress -OutboundOnly ([Bool]::Parse($_.OutboundOnly)) -ExceptionList $_.ExceptionList}

## Как проверить, что шаг выполнен?

Чтобы убедиться, что записи для замены адреса были импортированы из CSV-файла успешно, выполните следующие действия:

1.  Чтобы просмотреть все записи для замены адреса, выполните команду `Get-AddressRewriteEntry`.

2.  Чтобы просмотреть подробные сведения о конкретной записи для замены адреса, выполните команду `Get-AddressRewriteEntry <AddressRewriteIdentity> | Format-List`.

