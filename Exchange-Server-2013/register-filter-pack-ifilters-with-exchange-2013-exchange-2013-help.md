---
title: 'Регистрация фильтров IFilter из пакета фильтров с помощью Exchange 2013: Exchange 2013 Help'
TOCTitle: Регистрация фильтров IFilter из пакета фильтров с помощью Exchange 2013
ms:assetid: 0338980f-3a64-49d3-bc3c-bf6f10f88cb4
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ837174(v=EXCHG.150)
ms:contentKeyID: 50556327
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Регистрация фильтров IFilter из пакета фильтров с помощью Exchange 2013

 

_**Применимо к:**Exchange Server 2013_

_**Последнее изменение раздела:**2016-12-09_

Правила транспорта с условиями проверки вложений отвечают за извлечение текста при анализе содержимого вложений. Собственные средства Exchange 2013 позволяют проверить типы наиболее часто используемых вложений. Можно включить дополнительные типы вложений, зарегистрировав фильтры IFilter в Exchange 2013. В этой теме показано, как зарегистрировать фильтры IFilter, выпущенные корпорацией Майкрософт и сторонними поставщиками.

После регистрации фильтра IFilter для определенного типа файлов эти вложения можно будет проверять с помощью правил транспорта с условиями обработки вложений. В результате эти типы файлов больше не будут отвечать за запуск условия *AttachmentIsUnsupported*.

<table>
<thead>
<tr class="header">
<th><img src="images/Dd876857.Caution(EXCHG.150).gif" title="Внимание!" alt="Внимание!" />Внимание!</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>В процедуры, приведенные в этой теме, входит изменение реестра на серверах Exchange. Неправильное изменение реестра может привести к серьезным неполадкам, требующим переустановки операционной системы. Проблемы, возникшие в результате неправильного изменения реестра, могут оказаться неустранимыми. Перед внесением изменений в реестр выполните резервное копирование всех важных данных.<br />
Для выполнения данных процедур также необходимо остановить и перезапустить транспортную службу Microsoft Exchange на серверах почтовых ящиков.</td>
</tr>
</tbody>
</table>


Дополнительные сведения о задачах управления, связанных с правилами транспорта, см. в разделе [Управление правилами потока обработки почты](manage-mail-flow-rules-exchange-2013-help.md).

## Что нужно знать перед началом работы?

  - Предполагаемое время для завершения каждой процедуры: 5 минут на сервер.

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись "Параметры конфигурации сервера Exchange" в разделе [Разрешения инфраструктуры Exchange и командной консоли](exchange-and-shell-infrastructure-permissions-exchange-2013-help.md).

  - Приведенные ниже процедуры необходимо выполнять на серверах с установленной ролью сервера почтовых ящиков Exchange 2013. Если добавить дополнительные серверы почтовых ящиков после этих процедур, их понадобится выполнить снова на вновь подготовленных серверах.

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

<table>
<thead>
<tr class="header">
<th><img src="images/Bb124558.tip(EXCHG.150).gif" title="Совет" alt="Совет" />Совет.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>.</td>
</tr>
</tbody>
</table>


## Что необходимо сделать?

## Регистрация пакета фильтров Microsoft Office 2010

По умолчанию правила транспорта Exchange не поддерживают приведенные ниже типы файлов Office.

  - Office OneNote

  - Office Publisher

Чтобы обеспечить поддержку данных файлов, разверните пакет фильтров Microsoft Office 2010. Этот пакет фильтров не развертывается во время установки Exchange 2013 и не является необходимым условием для развертывания.

## Развертывание пакета фильтров Microsoft Office 2010

Развертывание пакета фильтров Office 2010 состоит из двух основных этапов:

  - загрузка и установка пакета фильтров, отвечающего за регистрацию фильтров IFilter в Windows (поиск);

  - изменение реестра для регистрации фильтров IFilter в Exchange 2013. Это обеспечивает поддержку проверки вложений для форматов файлов.

<table>
<thead>
<tr class="header">
<th><img src="images/Dd876857.important(EXCHG.150).gif" title="Важно" alt="Важно" />Важно!</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Эту процедуру необходимо выполнить на каждом сервере почтовых ящиков в организации.</td>
</tr>
</tbody>
</table>


1.  Загрузка и сохранение пакета фильтров Microsoft Office 2010 (`FilterPack64bit.exe`) из [Центра загрузки Майкрософт](https://go.microsoft.com/fwlink/?linkid=191548).

2.  Запустите файл `FilterPack64bit.exe` на своем сервере почтовых ящиков и соблюдайте инструкции для завершения установки.

3.  Запустите редактор реестра и перейдите к приведенному ниже подразделу реестра.
    
        HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ExchangeServer\v15\HubTransportRole\CLSID

4.  В разделе **CLSID** добавьте подраздел для файлов OneNote следующим образом.
    
    1.  Щелкните правой кнопкой мыши **CLSID**, а затем последовательно выберите пункты **Создать** и **Раздел**.
    
    2.  Измените имя нового раздела на `{B8D12492-CE0F-40AD-83EA-099A03D493F1}`.
    
    3.  Щелкните только что созданный раздел и задайте значение **(По умолчанию)** для расположения, в котором установлен пакет фильтров Office 2010. По умолчанию пакет фильтров устанавливается в следующем расположении: `C:\Program Files\Common Files\Microsoft Shared\Filters\ONIFilter.dll`.
    
    4.  Щелкните правой кнопкой мыши **{B8D12492-CE0F-40AD-83EA-099A03D493F1}**, а затем последовательно выберите пункты **Создать** и **Строковый параметр**.
    
    5.  Присвойте новому строковому параметру имя `ThreadingModel` и установите для него значение `Both`.

5.  В разделе **CLSID** добавьте подраздел для файлов Publisher следующим образом.
    
    1.  Щелкните правой кнопкой мыши **CLSID**, а затем последовательно выберите пункты **Создать** и **Раздел**.
    
    2.  Измените имя нового раздела на `{A7FD8AC9-7ABF-46FC-B70B-6A5E5EC9859A}`.
    
    3.  Щелкните только что созданный раздел и задайте значение **(По умолчанию)** для расположения, в котором установлен пакет фильтров Office 2010. По умолчанию пакет фильтров устанавливается в следующем расположении: `C:\Program Files\Common Files\Microsoft Shared\Filters\PUBFILT.dll`.
    
    4.  Щелкните правой кнопкой мыши **{A7FD8AC9-7ABF-46FC-B70B-6A5E5EC9859A}**, а затем последовательно выберите пункты **Создать** и **Строковый параметр**.
    
    5.  Присвойте новому строковому параметру имя `ThreadingModel` и установите для него значение `Both`.

6.  Откройте следующий раздел реестра:
    
        HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ExchangeServer\v15\HubTransportRole\filters

7.  В разделе **фильтры** добавьте подраздел для расширений ONE следующим образом.
    
    1.  Щелкните правой кнопкой мыши **фильтры**, а затем последовательно выберите пункты **Создать** и **Раздел**.
    
    2.  Измените имя нового раздела на `.one`.
    
    3.  Щелкните только что созданный раздел и установите значение **(По умолчанию)** для `{B8D12492-CE0F-40AD-83EA-099A03D493F1}`.

8.  В разделе **фильтры** добавьте подраздел для расширений PUB следующим образом.
    
    1.  Щелкните правой кнопкой мыши **фильтры**, а затем последовательно выберите пункты **Создать** и **Раздел**.
    
    2.  Измените имя нового раздела на `.pub`.
    
    3.  Щелкните только что созданный раздел и установите значение **(По умолчанию)** для `{A7FD8AC9-7ABF-46FC-B70B-6A5E5EC9859A}`.

9.  Закройте редактор реестра.

10. На сервере почтовых ящиков остановите и перезапустите приведенные ниже службы в указанном порядке.
    
    1.  Остановите службу транспорта Microsoft Exchange
    
    2.  Остановите службу Microsoft Filtering Management Service.
    
    3.  Запустите службу Microsoft Filtering Management Service.
    
    4.  Запустите службу транспорта Microsoft Exchange.

## Как проверить, что все получилось?

Чтобы проверить успешность регистрации фильтров IFilter пакета фильтров Microsoft Office 2010, выполните следующее.

1.  Создайте правило транспорта с приведенными ниже свойствами. Дополнительные сведения о создании правил транспорта см. в разделе [Управление правилами потока обработки почты](manage-mail-flow-rules-exchange-2013-help.md).
    
      - Отправителем является ваш почтовый ящик.
    
      - Содержимое любого вложения включает "Фильтры IFilter проверки".
    
      - Создайте отчет об инциденте и отправьте его в свой почтовый ящик.

2.  Создайте файл OneNote, содержащий фразу "Фильтры IFilter проверки", вложите его в новое сообщение электронной почты и отправьте на свой адрес.

3.  Убедитесь, что получили отчет об инциденте для только что созданного правила транспорта. Это подтверждает, что обработчик правил смог проанализировать содержимое файла OneNote.

4.  Повторите шаги 2 и 3 с файлом Publisher.

## Регистрация сторонних фильтров IFilter для поддержки дополнительных форматов файлов

Зарегистрировав дополнительные сторонние фильтры IFilter, можно расширить возможности проверки вложений для дополнительных типов файлов. Поддержку дополнительных файлов можно добавить путем установки и регистрации фильтра IFilter для типа файла на каждом сервере почтовых ящиков.

<table>
<thead>
<tr class="header">
<th><img src="images/Dd876857.important(EXCHG.150).gif" title="Важно" alt="Важно" />Важно!</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Корпорация Майкрософт не тестировала фильтры IFilter сторонних поставщиков с помощью правил транспорта, поэтому рекомендуется развернуть и проверить все сторонние фильтры IFilter в тестовой среде, прежде чем развертывать их в своей рабочей среде.</td>
</tr>
</tbody>
</table>


## Развертывание фильтра Adobe PDF IFilter

В этой руководстве описано развертывание фильтра [Adobe PDF IFilter](https://www.adobe.com/support/downloads/detail.jsp?ftpid=4025) для поддержки обработки вложений формата PDF в правилах транспорта.

<table>
<thead>
<tr class="header">
<th><img src="images/JJ126620.note(EXCHG.150).gif" title="Примечание" alt="Примечание" />Примечание.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>По умолчанию Exchange 2013 поддерживает проверку PDF-файлов в правилах транспорта. Приведенный здесь пример PDF-файла используется, только чтобы показать, как можно расширить поддержку дополнительных типов файлов с помощью фильтров IFilter сторонних поставщиков.</td>
</tr>
</tbody>
</table>


1.  Загрузите [Adobe PDF IFilter](https://www.adobe.com/support/downloads/detail.jsp?ftpid=4025) и следуйте инструкциям по установке.

2.  Запустите редактор реестра и перейдите к приведенному ниже подразделу.
    
        HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ExchangeServer\v15\HubTransportRole\CLSID

3.  В разделе **CLSID** добавьте подраздел для PDF-файлов следующим образом.
    
    1.  Щелкните правой кнопкой мыши **CLSID**, а затем последовательно выберите пункты **Создать** и **Раздел**.
    
    2.  Измените имя нового раздела на `{E8978DA6-047F-4E3D-9C78-CDBE46041603}`.
        
        <table>
        <thead>
        <tr class="header">
        <th><img src="images/JJ126620.note(EXCHG.150).gif" title="Примечание" alt="Примечание" />Примечание.</th>
        </tr>
        </thead>
        <tbody>
        <tr class="odd">
        <td>Каждый фильтр IFilter имеет идентификатор уникального класса (CLSID). CLSID можно найти в документации по установке регистрируемого фильтра IFilter или путем поиска расширения файла в разделе реестра <code>HKEY_CLASSES_ROOT\CLSID</code>.</td>
        </tr>
        </tbody>
        </table>
    
    3.  Щелкните только что созданный раздел и задайте значение **(По умолчанию)** для расположения, в котором установлен фильтр PDF IFilter. По умолчанию фильтр PDF IFilter установлен в следующем расположении: `C:\Program Files\Adobe\Adobe PDF IFilter 9 for 64-bit platforms\bin\PDFFilter.dll`.

4.  Откройте следующий раздел реестра:
    
        HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ExchangeServer\v15\HubTransportRole\filters

5.  В разделе **фильтры** добавьте подраздел для расширений PDF следующим образом.
    
    1.  Щелкните правой кнопкой мыши **фильтры**, а затем последовательно выберите пункты **Создать** и **Раздел**.
    
    2.  Измените имя нового раздела на `.pdf`.
    
    3.  Щелкните только что созданный раздел и установите значение **(По умолчанию)** для `{E8978DA6-047F-4E3D-9C78-CDBE46041603}`.

6.  Закройте редактор реестра.

7.  На сервере почтовых ящиков остановите и перезапустите приведенные ниже службы в указанном порядке.
    
    1.  Остановите службу транспорта Microsoft Exchange.
    
    2.  Остановите службу Microsoft Filtering Management Service.
    
    3.  Запустите службу Microsoft Filtering Management Service.
    
    4.  Запустите службу транспорта Microsoft Exchange.

## Как проверить, что все получилось?

Выполните действия, приведенные в разделе Как проверить, что все получилось? ранее в этой теме (только вместо файлов Publisher используются PDF-файлы Adobe).

## Дополнительные сведения

[Использование правил транспорта для проверки вложений сообщений](use-transport-rules-to-inspect-message-attachments-exchange-2013-help.md)

[Правила обработки почтового потока и транспорта](mail-flow-rules-transport-rules-in-exchange-2013-exchange-2013-help.md)

[Условия правил транспорта (предикаты)](mail-flow-rule-conditions-and-exceptions-predicates-in-exchange-2013-exchange-2013-help.md)

[Действия правил транспорта](mail-flow-rule-actions-in-exchange-2013-exchange-2013-help.md)

