---
title: 'Включение или отключение электронной почты для почтового контакта: Exchange 2013 Help'
TOCTitle: Включение или отключение электронной почты для почтового контакта
ms:assetid: ca47441f-1aa4-4958-aba5-18d51e59837e
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Bb124552(v=EXCHG.150)
ms:contentKeyID: 50556484
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Включение или отключение электронной почты для почтового контакта

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2012-12-05_

Можно отключить почту для существующего почтового контакта в организации Exchange. Если отключить электронную почту почтового контакта, он удаляется из Exchange и из адресной книги организации. Если почтовый контакт является членом группы рассылки, он более не получает почту, отправляемую группе. Кроме того, атрибуты Exchange удаляются из контакта с включенной поддержкой почты объектов в Active Directory, но сам контакт и его атрибуты, не относящихся к Exchange (например, контактные данные, а также информация об организации) сохраняются в Active Directory.

После отключения электронной почты для почтового контакта можно включить поддержку почты для контакта, выполнив командлет **Enable-MailContact** в командной консоли Exchange. Этот командлет также можно использовать для включения поддержки почты для любого контакта Active Directory.

Сведения о дополнительных задачах по управлению почтовыми контактами см. в разделе [Управление почтовыми контактами](manage-mail-contacts-exchange-2013-help.md).

## Что нужно знать перед началом работы?

  - Предполагаемое время для завершения каждой процедуры: 2 минут.

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись «Почтовые контакты» в разделе [Разрешения получателей](recipients-permissions-exchange-2013-help.md).

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

> [!TIP]  
> Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>..


## Что необходимо сделать?

## Отключение электронной почты почтового контакта

Как было сказано выше, после отключения электронной почты для почтового контакта атрибуты Exchange удаляются из соответствующего объекта контакта Active Directory, но сам контакт сохраняется. Почтовый контакт удаляется из списка почтовых контактов в EAC, но вы можете просматривать и контролировать соответствующий объект контакта в Active Directory, используя оснастку "Active Directory — пользователи и компьютеры" или командлеты **Get-Contact** и **Set-Contact** в командной консоли.

## Использование EAC для отключения электронной почты у почтового контакта

1.  В центре администрирования Exchange выберите **Получатели** \> **Контакты**.

2.  В списке контактов щелкните почтовый контакт, для которого требуется отключить электронную почту.

3.  Нажмите кнопки **Дополнительно**![Значок дополнительных параметров](images/JJ150550.5381819e-3b21-4873-8714-e9b956290b28(EXCHG.150).gif "Значок дополнительных параметров") и **Отключить**.

4.  Будет выведено предупреждение с запросом о том, действительно ли вы хотите отключить выбранный почтовый контакт. Чтобы продолжить, нажмите кнопку **Да**.

Почтовый контакт будет удален из списка контактов.

## Использование командной консоли для отключения электронной почты у почтового контакта

В этом примере отключается электронная почта для почтового контакта Neil Black.

    Disable-MailContact -Identity "Neil Black"

Подробные сведения о синтаксисе и параметрах см. в разделе [Disable-MailContact](https://technet.microsoft.com/ru-ru/library/aa997465\(v=exchg.150\)).

## Как проверить, что все получилось?

Чтобы проверить, успешно ли выключена почта у почтового контакта, выполните одно из следующих действий.

1.  В EAC перейдите к разделу **Получатели** \> **Контакты** и убедитесь, что почтовый контакт больше не отображается.

2.  В оснастке "Active Directory — пользователи и компьютеры" щелкните правой кнопкой мыши контакт, затем щелкните **Свойства**. На вкладке **Общие** поле **Электронная почта** должно быть пустым. Это подтверждает, что для контакта не включена поддержка почты.

3.  В консоли Shell выполните следующую команду:
    
        Get-MailContact
    
    Контакт, для которого вы отключили почту, не возвращается в результатах выполнения командлета, так как он возвращает только контакты с включенной поддержкой почты.

4.  В консоли Shell выполните следующую команду:
    
        Get-Contact
    
    Контакт, отключенных сообщение для возвращается в результатах выполнения команды поскольку командлет возвращает все контактными объектами Active Directory.

## Использование командной консоли для включения поддержки почты для контактов

Можно использовать командлет **Enable-MailContact** для включения поддержки почты для существующих контактов Active Directory. Существует возможность включения поддержки почты для одного контакта или использования CSV-файла для включения поддержки почты для нескольких контактов.

## Использование командной консоли для включения поддержки почты для одного контакта

В этом примере включается поддержка почты для контакта Rene Valdes. Вы должны предоставить внешний адрес.

    Enable-MailContact -Identity "Rene Valdes" -ExternalEmailAddress renev@tailspintoys.com

## Использование командной консоли и CSV-файла для включения поддержки почты для нескольких контактов

При включении поддержки почты контактов в массовом порядке сначала следует экспортировать список контактов, для которых не включена поддержка почты, в CSV-файл, а затем добавить в него внешние адреса электронной почты с помощью текстового редактора, такого как Блокнот, или в приложении электронных таблиц, например в Microsoft Excel. После этого с помощью CSV-файла в командной консоли следует включить поддержку почты для контактов, указанных в CSV-файле.

1.  Выполните следующую команду, чтобы экспортировать список существующих контактов с включенной поддержкой почты в файл Contacts.csv на рабочем столе администратора.
    
        Get-Contact | Where { $_.RecipientType -eq "Contact" } | Out-File "C:\Users\Administrator\Desktop\Contacts.csv"
    
    Полученный в результате файл будет иметь примерно следующий вид:
    
        Name
        Walter Harp
        James Alvord
        Rainer Witt
        Susan Burk
        Ian Tien
        ...

2.  Добавьте заголовок столбца с именем **EmailAddress**, а затем добавьте адрес электронной почты для каждого контакта в файле. Имя и внешний адрес электронной почты для каждого контакта должны быть разделены запятыми. Обновленный файл будет иметь примерно следующий вид:
    
        Name,EmailAddress
        James Alvord,james@contoso.com
        Susan Burk,sburk@tailspintoys.com
        Walter Harp,wharp@tailspintoys.com
        Ian Tien,iant@tailspintoys.com
        Rainer Witt,rainerw@fourthcoffee.com
        ...

3.  Выполните следующую команду, чтобы использовать данные в CSV-файле для включения поддержки почты у контактов в файле.
    
        Import-CSV C:\Users\Administrator\Desktop\Contacts.csv | ForEach-Object {Enable-MailContact -Identity $_.Name -ExternalEmailAddress $_.EmailAddress}
    
    Результаты команды отображают сведения о новых почтовых контактах.

## Как проверить, что все получилось?

Чтобы убедиться в том, что массовое изменение контактов Active Directory прошло успешно, выполните одно из следующих действий:

  - В центре администрирования Exchange выберите **Получатели** \> **Контакты**. Новые почтовые контакты отображаются в списке контактов. Под **тип контакта**, тип является **почтового контакта**.
    
    > [!NOTE]  
    > Может потребоваться щелкнуть кнопку <strong>Обновить</strong><img src="images/Dd353189.85f271ca-32a4-426c-842a-d2172567099d(EXCHG.150).gif" title="Значок обновления" alt="Значок обновления" />, чтобы отобразить новые почтовые контакты.


  - В командной консоли Exchange выполните следующую команду для вывода информации о новых почтовых контактах.
    
        Get-MailContact | Format-Table Name,RecipientTypeDetails,ExternalEmailAddress

