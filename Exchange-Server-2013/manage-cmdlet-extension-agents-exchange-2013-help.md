---
title: 'Управление агентами расширения командлетов: Exchange 2013 Help'
TOCTitle: Управление агентами расширения командлетов
ms:assetid: 9141b3cb-ad13-4415-be2f-aa89f91445f5
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Dd298143(v=EXCHG.150)
ms:contentKeyID: 50556407
ms.date: 05/22/2018
mtps_version: v=EXCHG.150
ms.translationtype: MT
---

# Управление агентами расширения командлетов

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2012-11-19_

В этом разделе описано, как включить, отключить, просмотреть или изменить приоритет агентов расширения командлетов в Microsoft Exchange Server 2013. Дополнительные сведения об агентах расширения командлетов Exchange 2013 см. в разделе [Агенты расширения командлета](cmdlet-extension-agents-exchange-2013-help.md).

## Что нужно знать перед началом работы?

  - Предполагаемое время для завершения каждой процедуры: менее 5 минут

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье запись "Агенты расширения командлета" в разделе [Разрешения инфраструктуры Exchange и командной консоли](exchange-and-shell-infrastructure-permissions-exchange-2013-help.md).

  - Перед включением `Scripting Agent` убедитесь, что он правильно настроен. Дополнительные сведения о `Scripting Agent` см. в разделе [Агенты расширения командлета](cmdlet-extension-agents-exchange-2013-help.md).

  - Для выполнения этих процедур необходимо использовать командную консоль Exchange.

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

<table>
<thead>
<tr class="header">
<th><img src="images/Bb124558.tip(EXCHG.150).gif" title="Совет" alt="Совет" />Совет.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>.</td>
</tr>
</tbody>
</table>


## Что необходимо сделать?

## Включение агента расширения командлета

При включении агента расширения командлета в Exchange 2013 агент запускается на каждом сервере Exchange 2013 в организации. Когда агент включен, он доступен для использования командлетами для выполнения дополнительных операций.

<table>
<thead>
<tr class="header">
<th><img src="images/Dd876857.Caution(EXCHG.150).gif" title="Внимание!" alt="Внимание!" />Внимание!</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Перед включением агента убедитесь, что полностью осведомлены о работе агента и его влиянии на организацию.</td>
</tr>
</tbody>
</table>


В этом примере включается агент расширения командлета с помощью командлета **Enable-CmdletExtensionAgent**. Необходимо указать имя агента для включения при запуске командлета. Перед включением `Scripting Agent` убедитесь, что файл конфигурации `ScriptingAgentConfig.xml` развернут на всех серверах в организации. Если файл конфигурации не развернут, а `Scripting``Agent` включен, запуск всех командлетов кроме **Get** будет невозможен. В этом примере включается `Scripting Agent`.

    Enable-CmdletExtensionAgent "Scripting Agent"

Дополнительные сведения о синтаксисе и параметрах см. в разделе [Enable-CmdletExtensionAgent](https://technet.microsoft.com/ru-ru/library/dd335192\(v=exchg.150\)).

## Выключение агента расширения командлета

При отключении агента расширения командлета в Exchange 2013 агент отключается на каждом сервере Exchange 2013 в организации. При отключении агент становится недоступным для командлетов. Командлеты больше не смогут использовать этот агент для выполнения дополнительных операций.

<table>
<thead>
<tr class="header">
<th><img src="images/Dd876857.Caution(EXCHG.150).gif" title="Внимание!" alt="Внимание!" />Внимание!</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Перед отключением агента рекомендуется изучить принципы работы агента и влияние отключения агента на работу организации.</td>
</tr>
</tbody>
</table>


Чтобы отключить агент расширения командлета, используйте командлет **Disable-CmdletExtensionAgent**. При запуске командлета необходимо указать имя отключаемого агента. В данном примере отключается агент `Scripting Agent`.

    Disable-CmdletExtensionAgent "Scripting Agent"

Дополнительные сведения о синтаксисе и параметрах см. в разделе [Disable-CmdletExtensionAgent](https://technet.microsoft.com/ru-ru/library/dd298132\(v=exchg.150\)).

## Просмотр существующих агентов расширения командлетов

Просмотр агентов расширения командлетов позволяет увидеть, какие агенты запускаются первыми, и какие агенты включены в организации Exchange 2013. Дополнительные сведения о конвейере и командлете **Format-Table** см. в следующих разделах:

  - [Конвейеризация](https://technet.microsoft.com/ru-ru/library/aa998260\(v=exchg.150\))

  - [Работа с выходными данными команды](working-with-command-output-exchange-2013-help.md)

В этом примере показано, как получить дополнительные сведения об определенном агенте расширения командлета с помощью командлета **Get-CmdletExtensionAgent**. В этом примере возвращаются дополнительные сведения об `Mailbox Permissions Agent`.

    Get-CmdletExtensionAgent "Mailbox Permissions Agent"

В этом примере показано, как получить сведения о нескольких агентах расширения командлета с помощью командлета **Get-CmdletExtensionAgent**, а затем передать по конвейеру выходные данные в командлет **Format-Table**. В этом примере отображается список всех агентов расширения командлета в организации, а с помощью командлета **Format-Table** свойства **Name**, **Enabled** и **Priority** каждого агента отображаются в таблице.

    Get-CmdletExtensionAgent | Format-Table Name, Enabled, Priority

Дополнительные сведения о синтаксисе и параметрах см. в разделе [Get-CmdletExtensionAgent](https://technet.microsoft.com/ru-ru/library/dd297946\(v=exchg.150\)).

## Изменение приоритета агента расширения командлета

Функция изменения приоритета агента расширения командлета в Exchange 2013 используется, когда необходимо с помощью командлета вызвать определенный агент перед вызовом другого агента. Эта функция используется при необходимости создания настраиваемого сценария, запущенного в `Scripting Agent`, и определения для этого сценария приоритета над встроенным агентом. Дополнительные сведения о `Scripting Agent` см. в разделе [Агенты расширения командлета](cmdlet-extension-agents-exchange-2013-help.md).

<table>
<thead>
<tr class="header">
<th><img src="images/Dd876857.Caution(EXCHG.150).gif" title="Внимание!" alt="Внимание!" />Внимание!</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Изменение приоритета или замена функций встроенного агента являются дополнительными операциями. Убедитесь, что имеете полное представление о производимых изменениях.</td>
</tr>
</tbody>
</table>


Агенты упорядочены от нуля до максимального числа агентов. Чем ближе агент расположен к нулю, тем выше его приоритет. Агенты с более высоким приоритетом вызываются в первую очередь. Дополнительные сведения о приоритетах агентов см. в разделе [Агенты расширения командлета](cmdlet-extension-agents-exchange-2013-help.md).

В этом примере показано, как изменить приоритет агента расширения командлета с помощью командлета **Set-CmdletExtensionAgent**. В этом примере выполняется изменение значения приоритета `Scripting Agent` на 3.

    Set-CmdletExtensionAgent "Scripting Agent" -Priority 3

Дополнительные сведения о синтаксисе и параметрах см. в разделе [Set-CmdletExtensionAgent](https://technet.microsoft.com/ru-ru/library/dd335175\(v=exchg.150\)).

