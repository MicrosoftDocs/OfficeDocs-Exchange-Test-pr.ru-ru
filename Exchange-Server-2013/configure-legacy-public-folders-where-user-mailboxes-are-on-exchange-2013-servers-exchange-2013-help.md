---
title: 'Доступ к устаревшим общедоступным папкам с серверов Exchange 2013'
TOCTitle: Настройка устаревших общедоступных папок, почтовые ящики которых размещены на серверах Exchange 2013
ms:assetid: 1d5ca19e-696e-4054-a634-15dd34d952b7
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Dn690134(v=EXCHG.150)
ms:contentKeyID: 62281058
ms.date: 05/22/2018
mtps_version: v=EXCHG.150
ms.translationtype: MT
---

# Настройка устаревших общедоступных папок, почтовые ящики которых размещены на серверах Exchange 2013

 

_**Применимо к:** Exchange Server 2013, Exchange Server 2016_

_**Последнее изменение раздела:** 2017-03-27_

Как пользователи Exchange 2013 или Exchange 2016 для доступа к Exchange 2010 или предыдущих общих папок (также известной как устаревшие общедоступные папки).

## Что нужно знать перед началом работы

Пользователи, почтовые ящики которых находятся на Exchange Server 2013 или Exchange Server 2016, не смогут получить доступ к устаревшим общедоступным папкам из Outlook Web App, Outlook в Интернете или Outlook для Mac. Действия, описанные в этой статье работы для Exchange 2013 и Exchange 2016.

> [!NOTE]  
> После выполнения действий, описанных в этой статье, пользователи Outlook 2016 для Mac смогут получать доступ к общедоступным папкам прежних версий. Если клиенты в организации используют Outlook 2016 для Mac, убедитесь, что у них установлено обновление за апрель 2016 г. В противном случае такие пользователи не смогут получать доступ к общедоступным папкам в гибридной среде. Дополнительные сведения см. в статье <a href="https://docs.microsoft.com/ru-ru/exchange/collaboration-exo/public-folders/access-public-folders-with-outlook-2016-for-mac">Доступ к общедоступным папкам с помощью Outlook 2016 для Mac</a>.


## Действие 1. Реализация обнаружения общедоступных папок Exchange 2010

1.  Если ваши общедоступные папки размещены на Exchange 2010 или серверах более поздних версий, необходимо установить роль сервера клиентского доступа на всех серверах почтовых ящиков, имеющих базу данных общедоступных папок. Это позволит работать службе Microsoft Exchange RpcClientAccess, благодаря чему все клиенты смогут получать доступ к общедоступным папкам. Для серверов общедоступных папок Exchange 2007 не требуется роль клиентского доступа, и этот шаг можно пропустить. Дополнительные сведения см. в разделе [Установка Exchange Server 2010](install-exchange-2013-using-the-setup-wizard-exchange-2013-help.md).
    
    > [!NOTE]  
    > Этот сервер можно не учитывать при балансировке нагрузки клиентского доступа. Дополнительные сведения см. в статье <a href="https://technet.microsoft.com/ru-ru/library/ff625247(v=exchg.141).aspx">Общие сведения о балансировке нагрузки в Exchange 2010</a>.


2.  Создайте пустую базу данных почтовых ящиков на каждом сервере общедоступных папок.
    
    Для Exchange 2010 выполните приведенную ниже команду. Эта команда исключает базу данных почтовых ящиков из подсистемы балансировки нагрузки подготовки почтовых ящиков. Это предотвратит автоматическое добавление новых почтовых ящиков в эту базу данных.
    ```powershell
        New-MailboxDatabase -Server <PFServerName_with_CASRole> -Name <NewMDBforPFs> -IsExcludedFromProvisioning $true 
    ```
    Для Exchange 2007 выполните приведенную ниже команду.
    
    ```powershell
    New-MailboxDatabase -StorageGroup "<PFServerName>\StorageGroup>" -Name <NewMDBforPFs>
    ```
    
    > [!NOTE]  
    > Мы рекомендуем добавлять в эту базу данных единственный почтовый ящик — промежуточный почтовый ящик, который будет создан в действии 3. В этой базе данных почтовых ящиков не нужно добавлять никакие другие почтовые ящики.


3.  Создайте промежуточный почтовый ящик в новой базе данных почтовых ящиков и скройте его из адресной книги. Автообнаружение вернет SMTP этого почтового ящика как SMTP *DefaultPublicFolderMailbox*, чтобы путем разрешения этого SMTP клиент имел возможность получать доступ к серверу Exchange прежних версий для доступа к общедоступным папкам.
    
    ```powershell
        New-Mailbox -Name <PFMailbox1> -Database <NewMDBforPFs> 
    ```
   
    ```powershell
    Set-Mailbox -Identity <PFMailbox1> -HiddenFromAddressListsEnabled $true
    ```


4.  Для Exchange 2010 включите функцию автообнаружения, чтобы вернуть промежуточные почтовые ящики общедоступных папок. Этот шаг можно пропустить в Exchange 2007.
    
    ```powershell
    Set-MailboxDatabase <NewMDBforPFs> -RPCClientAccessServer <PFServerName_with_CASRole>
    ```

5.  Повторите предыдущие действия для каждого сервера общедоступных папок в своей организации.

## Действие 2. Настройка почтовых ящиков пользователей для доступа к устаревшим общедоступным папкам

Конечным действием этой процедуры является настройка почтовых ящиков пользователей для предоставления доступа к локальным общедоступным папкам прежних версий.

Разрешите локальным пользователям Exchange Server 2013 для доступа к устаревшим общедоступным папкам. Укажите все промежуточные почтовые ящики общедоступных папок, которые вы создали в [Step 2: Make remote public folders discoverable](https://docs.microsoft.com/ru-ru/exchange/collaboration-exo/public-folders/set-up-legacy-hybrid-public-folders). Выполните следующую команду на сервере Exchange 2013 с накопительным пакетом обновления 5 (CU5) или более поздней версии.
```powershell
    Set-OrganizationConfig -PublicFoldersEnabled Remote -RemotePublicFolderMailboxes ProxyMailbox1,ProxyMailbox2,ProxyMailbox3
```
> [!NOTE]  
> Вы сможете увидеть изменения, когда завершится синхронизация ActiveDirectory. Этот процесс может занять несколько часов.


## Как проверить, что это работает?

Войдите в Outlook с учетной записью пользователя, почтовый ящик которого размещен на сервере с Exchange Server 2013 CU5 или более поздней версией, и выполните следующие тесты общедоступных папок:

1.  Убедитесь, что клиент Outlook запущен.

2.  Удерживая клавишу CTRL, щелкните правой кнопкой значок Outlook в области уведомлений в правой части панели задач Windows.

3.  Выберите **Проверить автоматическую настройку электронной почты...**.

4.  Убедитесь, что средство проверки автоматической настройки электронной почты возвращает следующие данные на вкладке "XML":
    
      - \<PublicFolderInformation\>
    
      - \<SmtpAddress\>\<SMTP-адрес почтового ящика общедоступной папки\</SmtpAddress\>
    
      - \</PublicFolderInformation\>

5.  В клиенте Outlook выполните следующие действия.
    
      - Просмотрите иерархию общедоступных папок.
    
      - Проверьте разрешения.
    
      - создание и удаление общедоступных папок;
    
      - Опубликуйте содержимое в общедоступной папке и удалите его.

