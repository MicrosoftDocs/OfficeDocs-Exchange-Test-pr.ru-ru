---
title: 'Запросы на импорт и экспорт почтовых ящиков: Exchange 2013 Help'
TOCTitle: Запросы на импорт и экспорт почтовых ящиков
ms:assetid: 157a7d88-d3aa-4056-9a50-df67451b14be
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Ee633455(v=EXCHG.150)
ms:contentKeyID: 50487537
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Запросы на импорт и экспорт почтовых ящиков

 

_**Применимо к:**Exchange Server 2013_

_**Последнее изменение раздела:**2015-04-07_

С помощью наборов командлетов **MailboxImportRequest** или **MailboxExportRequest** в командной консоли Exchange можно импортировать данные из PST-файлов и экспортировать данные в эти файлы. Запущенный запрос на экспорт или импорт почтового ящика выполняется асинхронно службой репликации почтовых ящиков Microsoft Exchange. Служба репликации почтовых ящиков размещается на всех серверах клиентского доступа Exchange 2010 и отвечает за перемещение почтовых ящиков, а также за импорт и экспорт PST-файлов.

**Содержание**

Причины для импорта или экспорта данных почтовых ящиков

Преимущества использования запросов на импорт и экспорт

Замечания

Импорт данных почтового ящика

Экспорт данных почтового ящика

## Причины для импорта или экспорта данных почтовых ящиков

Импорт или экспорт данных почтовых ящиков может потребоваться по следующим причинам:

  - **Удовлетворение требований соответствия**   Содержимое почтового ящика может быть экспортировано в файл PST в целях представления. После экспорта содержимое можно импортировать в почтовый ящик, используемый специально в целях обеспечения соответствия.

  - **Создание моментального снимка почтового ящика**   Создание снимка некоторых почтовых ящиков устраняет необходимость сохранения всего набора резервных копий для базы данных почтовых ящиков.

  - **Перемещение файла PST пользователя в его или ее почтовый ящик или личный архив**   Пользователи Microsoft Outlook могут сохранять свою электронную почту локально в виде PST-файлов. С помощью командлета [New-MailboxImportRequest](https://technet.microsoft.com/ru-ru/library/ff607310\(v=exchg.150\)) можно перемещать данные из файлов PST пользователя в его почтовый ящик или личный архив. Это простой способ для передачи электронной почты с локального компьютера пользователя на серверы Exchange.

## Преимущества использования запросов на импорт и экспорт

К преимуществам использования запросов на импорт и экспорт в Exchange 2013 относится следующее:

  - В состав Exchange 2013 входит поставщик услуг PST, который может считывать и записывать PST-файлы.

  - Асинхронное выполнение запросов на экспорт и импорт. Этот процесс выполняется службой репликации почтовых ящиков, которая использует инфраструктуры очередей и регулировки.

  - Возможность импорта файлов PST непосредственно в личный архив пользователя.

  - Одновременный экспорт или импорт нескольких файлов PST.

  - Размещение файлов PST на любом общем сетевом диске, доступном для серверов Exchange.

  - Exchange 2013 поддерживает следующие PST-файлы: файлы в кодировке Юникод, созданные в Office Outlook 2007 и Outlook 2010;

## Замечания

Перед экспортом или импортом данных почтовых ящиков необходимо учитывать следующее.

  - Для экспорта или импорта данных почтовых ящиков необходимо настроить общую сетевую папку, доступную для серверов Exchange организации. Вам также следует предоставить группе "Доверенная подсистема Exchange" разрешение на чтение и запись, чтобы эта группа могла получить доступ к общей сетевой папке, где импортируются и экспортируются данные почтовых ящиков. Если не предоставить это разрешение, отображается сообщение об ошибке, информирующее о том, что Exchange не удалось установить подключение к целевому почтовому ящику.

  - Максимальный размер файла PST, поддерживаемый Outlook, не должен превышать 50 ГБ. Поэтому не рекомендуется импортировать файлы PST размером больше 50 ГБ. Файлы PST для почтовых ящиков больше 50 ГБ можно разбить на несколько частей, включив или исключив определенные папки или используя фильтр содержимого.

  - Запросы на импорт и экспорт выполняются службой репликации почтовых ящиков, которая также обрабатывает запросы на перемещение и восстановление почтовых ящиков. Все запросы помещаются в очередь и регулируются службой репликации почтовых ящиков.

  - Импорт и экспорт данных почтовых ящиков может занять несколько часов в зависимости от размера файла, пропускной способности сети и регулирования, выполняемого службой репликации почтовых ящиков.

  - Импорт данных в общедоступную папку или базу данных общедоступных папок невозможен.

## Импорт данных почтового ящика

Командлет **MailboxImportRequest** позволяет импортировать данные из файла PST в почтовый ящик или личный архив. При импорте данных почтовых ящиков из файла PST можно установить следующие параметры.

<table>
<thead>
<tr class="header">
<th><img src="images/JJ126620.note(EXCHG.150).gif" title="Примечание" alt="Примечание" />Примечание.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Почтовый ящик, в который импортируются данные, должен существовать. Нельзя импортировать данные в учетную запись пользователя, у которой отсутствует почтовый ящик.</td>
</tr>
</tbody>
</table>


  - Данные можно импортировать в другую учетную запись пользователя, отличную от учетной записи, из которой они были экспортированы. Например, можно экспортировать данные из почтового ящика john@contoso.com и импортировать их в legaldiscovery@contoso.com.

  - Можно импортировать элементы только в личный архив пользователя, установив параметр *IsArchive*.

  - Сообщения связанных папок в файлах PST можно импортировать с помощью параметра *AssociatedMessagesCopyOption*. Сопоставленные сообщения содержат скрытые данные о правилах, представлениях и формах. Импортируются все сообщения из системы безопасности, если они существуют в PST-файле.

  - С помощью параметров *IncludeFolders* или *ExcludeFolders* можно соответственно включать в импорт определенные папки или исключать их из него.

  - Папку "Элементы для восстановления" можно исключить с помощью параметра *ExcludeDumpster*. По умолчанию запрос на импорт включает в себя папку пользователя "Элементы для восстановления", если она существует в файле PST.

## Командлеты запроса на импорт почтовых ящиков

Для запросов на импорт почтовых ящиков используются следующие командлеты.


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Командлет</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607310(v=exchg.150)">New-MailboxImportRequest</a></p></td>
<td><p>Запускает процесс импорта данных из PST-файла в почтовый ящик или личный архив. Для почтового ящика можно создать несколько запросов на импорт. Каждый запрос должен иметь уникальное имя.</p></td>
</tr>
<tr class="even">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607317(v=exchg.150)">Set-MailboxImportRequest</a></p></td>
<td><p>Изменяет параметры запроса на импорт после создания запроса или восстановления после сбоя запроса.</p></td>
</tr>
<tr class="odd">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607309(v=exchg.150)">Suspend-MailboxImportRequest</a></p></td>
<td><p>Приостанавливает запрос на импорт в любое время после создания запроса, но до того, как он достигнет состояния &quot;Завершено&quot;.</p></td>
</tr>
<tr class="even">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607306(v=exchg.150)">Resume-MailboxImportRequest</a></p></td>
<td><p>Возобновляет запрос на импорт, который был приостановлен или завершен с ошибкой.</p></td>
</tr>
<tr class="odd">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607311(v=exchg.150)">Remove-MailboxImportRequest</a></p></td>
<td><p>Удаляет полностью или частично выполненные запросы на импорт. Выполненные запросы на импорт не удаляются автоматически. Для их удаления используется данный командлет.</p></td>
</tr>
<tr class="even">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607368(v=exchg.150)">Get-MailboxImportRequest</a></p></td>
<td><p>Просмотр общих сведений о запросе на импорт.</p></td>
</tr>
<tr class="odd">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607315(v=exchg.150)">Get-MailboxImportRequestStatistics</a></p></td>
<td><p>Просмотр подробных сведений о запросе на импорт.</p></td>
</tr>
</tbody>
</table>


## Экспорт данных почтового ящика

Для экспорта данных почтовых ящиков в файл PST используется командлет **MailboxExportRequest**. Можно экспортировать несколько почтовых ящиков одновременно, однако при этом для каждого файла PST записывается только один запрос за раз. При экспорте данных почтовых ящиков в файл PST можно установить следующие параметры.

  - Данные личного архива можно экспортировать с помощью параметра *IsArchive*.

  - Фильтровать экспортируемые сообщения можно с помощью параметра *ContentFilter*. Сообщения можно фильтровать по содержимому, вложениям, отправителям, получателям, категориям входящих сообщений, важности, типу и размеру сообщений, а также по дате отправки, получения или истечения срока действия.

  - С помощью параметров *IncludeFolders* или *ExcludeFolders* можно включать в экспорт определенные папки или исключать их из него. При экспорте данных из почтового ящика Exchange 2013 также можно исключить папку "Элементы для восстановления" с помощью параметра *ExcludeDumpster*.

  - Связанные сообщения можно экспортировать с помощью параметра *AssociatedMessagesCopyOption*. Сопоставленные сообщения содержат скрытые данные о правилах, представлениях и формах. По умолчанию связанные элементы не копируются в файл PST.

## Командлеты запроса на экспорт почтовых ящиков

Для запросов на экспорт почтовых ящиков используются следующие командлеты.


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Командлет</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607299(v=exchg.150)">New-MailboxExportRequest</a></p></td>
<td><p>Запускает процесс экспорта данных из основного почтового ящика или личного архива в PST-файл. Для почтового ящика можно создать несколько запросов на экспорт. Каждый запрос должен иметь уникальное имя.</p></td>
</tr>
<tr class="even">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607312(v=exchg.150)">Set-MailboxExportRequest</a></p></td>
<td><p>Изменяет параметры запроса на экспорт после создания запроса или восстановления после сбоя запроса.</p></td>
</tr>
<tr class="odd">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607305(v=exchg.150)">Suspend-MailboxExportRequest</a></p></td>
<td><p>Приостанавливает запрос на экспорт в любое время после создания запроса, но до того, как он достигнет состояния &quot;Завершено&quot;.</p></td>
</tr>
<tr class="even">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607476(v=exchg.150)">Resume-MailboxExportRequest</a></p></td>
<td><p>Возобновляет запрос на экспорт, который был приостановлен или завершен с ошибкой.</p></td>
</tr>
<tr class="odd">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607464(v=exchg.150)">Remove-MailboxExportRequest</a></p></td>
<td><p>Удаляет полностью или частично выполненные запросы на экспорт. Выполненные запросы на экспорт не удаляются автоматически. Для их удаления используется данный командлет.</p></td>
</tr>
<tr class="even">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607479(v=exchg.150)">Get-MailboxExportRequest</a></p></td>
<td><p>Просмотр общих сведений о запросе на экспорт.</p></td>
</tr>
<tr class="odd">
<td><p><a href="https://technet.microsoft.com/ru-ru/library/ff607316(v=exchg.150)">Get-MailboxExportRequestStatistics</a></p></td>
<td><p>Просмотр подробных сведений о запросе на экспорт.</p></td>
</tr>
</tbody>
</table>

