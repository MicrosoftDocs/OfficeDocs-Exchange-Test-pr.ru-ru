---
title: 'Перемещение базы данных почтовых ящиков с помощью переносимости базы данных: Exchange 2013 Help'
TOCTitle: Перемещение базы данных почтовых ящиков с помощью переносимости базы данных
ms:assetid: a765ead1-43bc-4786-ae93-1835cacfc8fc
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Dd876926(v=EXCHG.150)
ms:contentKeyID: 51408059
ms.date: 04/30/2018
mtps_version: v=EXCHG.150
ms.translationtype: HT
---

# Перемещение базы данных почтовых ящиков с помощью переносимости базы данных

 

_**Применимо к:** Exchange Server 2013_

_**Последнее изменение раздела:** 2014-06-16_

Можно использовать переносимость базы данных, чтобы перемещать базу данных почтовых ящиков Microsoft Exchange Server 2013 между серверами почтовых ящиков Exchange 2013 в одной организации. Это позволит сократить общее время восстановления для некоторых сценариев сбоя. Дополнительные сведения см. в разделе [Переносимость баз данных](database-portability-exchange-2013-help.md).

## Что нужно знать перед началом работы

  - Предполагаемое время для завершения: 5 минут, плюс время, необходимое для восстановления данных, перемещения файлов базы данных и ожидания завершения процесса репликации Active Directory.

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись "Восстановление почтового ящика" в разделе [Разрешения получателей](recipients-permissions-exchange-2013-help.md).

  - Центр администрирования Exchange нельзя использовать для перемещения почтовых ящиков пользователей в восстановленную или аварийную базу данных с помощью функции переноса баз данных.

> [!TIP]  
> Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>..


## Использование командной консоли Exchange для перемещения почтовых ящиков пользователей в восстановленную или аварийную базу данных с помощью переносимости базы данных

1.  Убедитесь, что работа базы данных, которую необходимо переместить, завершена нормально. Если работа база данных не завершена должным образом, выполните "мягкое" восстановление.
    
    > [!NOTE]  
    > При выполнении &quot;мягкого&quot; восстановления все незафиксированные файлы журналов фиксируются в базе данных. При отсутствии некоторых необходимых файлов журналов невозможно выполнить &quot;мягкое&quot; восстановление. Перейдите к шагу 2.
    
    Чтобы зафиксировать все незафиксированные файлы журналов в базе данных, в командной строке запустите следующую команду.
    
        ESEUTIL /R <Enn>
    
    > [!NOTE]  
    > Параметр &lt;E<em>nn</em>&gt; указывает префикс файлов журналов для базы данных, в которой необходимо воспроизвести файлы журнала. Префикс файлов журналов, указанный с помощью параметра &lt;E<em>nn</em>&gt;, является обязательным параметром команды Eseutil /r.


2.  Создайте базу данных на сервере, используя следующий синтаксис:
    
        New-MailboxDatabase -Name <DatabaseName> -Server <ServerName> -EdbFilePath <DatabaseFileNameandPath> -LogFolderPath <LogFilesPath>

3.  Укажите атрибут *This database can be over written by restore* с помощью следующей синтаксической конструкции.
    
        Set-MailboxDatabase <DatabaseName> -AllowFileRestore $true

4.  Переместите файлы базы данных (EDB-файл, файлы журналов и каталог поиска Exchange ) в папку базы данных, указанную при создании новой базы данных.

5.  Подключите базу данных с помощью следующей синтаксической конструкции:
    
        Mount-Database <DatabaseName>

6.  После подключения базы данных измените параметры учетной записи пользователя с помощью командлета [Set-Mailbox](https://technet.microsoft.com/ru-ru/library/bb123981\(v=exchg.150\)), чтобы учетная запись указывала на почтовый ящик на новом сервере почтовых ящиков. Чтобы переместить всех пользователей из старой базы данных в новую, введите команду в следующем формате.
    
        Get-Mailbox -Database <SourceDatabase> |where {$_.ObjectClass -NotMatch '(SystemAttendantMailbox|ExOleDbSystemMailbox)'}| Set-Mailbox -Database <TargetDatabase>

7.  Инициировать доставку любых сообщений, оставшихся в очередях, можно с помощью следующей команды.
    
        Get-Queue <QueueName> | Retry-Queue -Resubmit $true

После выполнения репликации Active Directory все пользователи получают доступ к своим почтовым ящикам на новом сервере Exchange. Большинство клиентов перенаправляются через службу автообнаружения. Пользователи Microsoft Office Outlook Web App также перенаправляются автоматически.

## Как проверить, что все получилось?

Чтобы убедиться, что почтовый ящик успешно перемещен, выполните следующие действия.

  - Откройте почтовый ящик с помощью программы Outlook Web App.

  - Откройте почтовый ящик с помощью Microsoft Outlook.

