---
title: 'Добавление записи роли в роль верхнего уровня с незаданной областью: Exchange 2013 Help'
TOCTitle: Добавление записи роли в роль верхнего уровня с незаданной областью
ms:assetid: 52fd3f20-c348-49d5-9bdb-f2cbf780cf2d
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Dd979789(v=EXCHG.150)
ms:contentKeyID: 50488244
ms.date: 05/22/2018
mtps_version: v=EXCHG.150
ms.translationtype: MT
---

# Добавление записи роли в роль верхнего уровня с незаданной областью

 

_**Применимо к:**Exchange Server 2013_

_**Последнее изменение раздела:**2012-10-03_

К ролям управления верхнего уровня с незаданной областью можно добавить сценарии или командлеты, не относящиеся к серверу Exchange, при необходимости создать новые сценарии или командлеты, не относящиеся к серверу Exchange, доступные для существующих ролей с незаданной областью. Эти сценарии и командлеты, не относящиеся к серверу Exchange, добавляются в качестве записей роли управления для ролей управления верхнего уровня с незаданной областью. Затем их можно использовать для записей ролей верхнего уровня с незаданной областью или любых ролей с незаданной областью, созданных на основе ролей верхнего уровня. Дополнительные сведения о записях ролей с незаданной областью см. в разделе [Общие сведения о ролях управления](understanding-management-roles-exchange-2013-help.md).

<table>
<thead>
<tr class="header">
<th><img src="images/JJ126620.note(EXCHG.150).gif" title="Примечание" alt="Примечание" />Примечание.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Чтобы изменить запись роли на роль управления, содержащую командлеты Exchange, см раздел <a href="change-a-role-entry-exchange-2013-help.md">Изменение записи роли</a>.</td>
</tr>
</tbody>
</table>


Необходимы сведения о других задачах управления, связанных с ролями? см. в разделе [Дополнительные разрешения](advanced-permissions-exchange-2013-help.md).

## Что нужно знать перед началом работы?

  - Предполагаемое время для завершения каждой процедуры: 5 минут

  - Для выполнения этих процедур необходимы соответствующие разрешения. Сведения о необходимых разрешениях см. в статье Запись "Роли управления" в разделе [Разрешения управления ролями](role-management-permissions-exchange-2013-help.md).

  - Для выполнения этих процедур необходимо использовать командную консоль Exchange.

  - По умолчанию функция добавления записи для роли верхнего уровня с незаданной областью не предусмотрена ни для одной из групп ролей управления. Необходимо предварительно назначить роль управления ролью с незаданной областью для пользователя или для универсальной группы безопасности или группы ролей, участником которой является пользователь. Затем пользователь сможет добавлять запись роли верхнего уровня с незаданной областью. Дополнительные сведения о добавлении роли группе ролей, пользователю или универсальной группе безопасности см. в следующих разделах.
    
      - [Управление группами ролей](manage-role-groups-exchange-2013-help.md)
    
      - [Добавление роли для пользователя или универсальной группы безопасности](add-a-role-to-a-user-or-usg-exchange-2013-help.md)

  - Сочетания клавиш для процедур, описанных в этой статье, приведены в статье [Сочетания клавиш в Центре администрирования Exchange](keyboard-shortcuts-in-the-exchange-admin-center-exchange-online-protection-help.md).

<table>
<thead>
<tr class="header">
<th><img src="images/Bb124558.tip(EXCHG.150).gif" title="Совет" alt="Совет" />Совет.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Возникли проблемы? Обратитесь за помощью к участникам форумов, посвященных Exchange. Посетите форумы по таким продуктам: <a href="https://go.microsoft.com/fwlink/p/?linkid=60612">Exchange Server</a>, <a href="https://go.microsoft.com/fwlink/p/?linkid=267542">Exchange Online</a> или <a href="https://go.microsoft.com/fwlink/p/?linkid=285351">Exchange Online Protection</a>.</td>
</tr>
</tbody>
</table>


## Что необходимо сделать?

## Добавление записи роли сценария для роли верхнего уровня с незаданной областью

Чтобы добавить сценарий для существующей роли с незаданной областью, используйте эту процедуру. Сведения о добавлении командлета, не относящегося к серверу Exchange, для существующей роли с незаданной областью см. в подразделе "Добавление записи роли командлета, не относящегося к серверу Exchange, для роли верхнего уровня с незаданной областью" далее в этом разделе.

Чтобы добавить сценарий Windows PowerShell роли верхнего уровня с незаданной областью, необходимо добавить роли запись роли управления. Запись роли содержит имя сценария и параметры сценария, которые необходимо сделать доступными для этой роли.

Сценарий должен находиться в каталоге сценариев в пути установки Microsoft Exchange Server 2013 на каждом сервере Exchange 2013, к которому будут подключаться пользователи для запуска сценария. Если у пользователя есть доступ для запуска сценария, но сценарий не размещен на сервере Exchange 2013, к которому подключен пользователь, возникнет ошибка. Путь к каталогу сценариев по умолчанию: C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Scripts.

После того, как сценарий скопирован на соответствующие серверы Exchange 2013 и было решено, какие параметры сценария необходимо использовать, создайте запись роли, используя следующий синтаксис.

    Add-ManagementRoleEntry <unscoped top-level role name>\<script filename> -Parameters <parameter 1, parameter 2, parameter...> -Type Script -UnscopedTopLevel

В этом примере добавляется сценарий BulkProvisionUsers.ps1 к роли IT Scripts с параметрами *Name* и *Location*.

    Add-ManagementRoleEntry "IT Scripts\BulkProvisionUsers.ps1" -Parameters Name, Location -Type Script -UnscopedTopLevel

<table>
<thead>
<tr class="header">
<th><img src="images/JJ126620.note(EXCHG.150).gif" title="Примечание" alt="Примечание" />Примечание.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Командлет <strong>Add-ManagementRoleEntry</strong> выполняет стандартную проверку, чтобы убедиться, что добавлены только те параметры, которые существуют в сценарии. Но после добавления записи роли никакой дальнейшей проверки не следует. При добавлении или удалении параметров позже необходимо вручную обновлять записи роли, которые содержат сценарий.</td>
</tr>
</tbody>
</table>


## Добавление записи роли командлета, не относящегося к серверу Exchange, для роли верхнего уровня с незаданной областью

Чтобы добавить командлет, не относящийся к серверу Exchange, для существующей роли с незаданной областью, используйте эту процедуру. Сведения о добавлении сценария для существующей роли с незаданной областью см. в подразделе "Добавление записи роли сценария для роли верхнего уровня с незаданной областью" выше в этом разделе.

Чтобы добавить командлет, отличный от Exchange, к роли верхнего уровня с незаданной областью, необходимо добавить роли запись роли управления. Запись роли содержит оснастку командлета, имя командлета и параметры командлета, которые необходимо сделать доступными для этой роли.

При добавлении командлетов, отличных от Exchange, в новую роль, командлеты должны быть установлены на каждом сервере Exchange 2013, к которым будут подключаться пользователи для выполнения командлетов. Сведения о том, как правильно установить и зарегистрировать оснастки Windows PowerShell, содержащие необходимые командлеты, см. в документации к продукту.

После установки оснастки Windows PowerShell, которая содержит командлеты на соответствующих серверах Exchange 2013, и выбора необходимых параметров командлета создайте запись роли, используя следующий синтаксис.

    Add-ManagementRoleEntry <unscoped top-level role name>\<cmdlet name> -PSSnapinName <snap-in name> -Parameters <parameter 1, parameter 2, parameter...> -Type Cmdlet -UnscopedTopLevel

В этом примере добавляется командлет **Set-WidgetConfiguration** в оснастке Contoso.Admin.Cmdlets для роли Widget Cmdlets с параметрами *Database* и *Size*.

    Add-ManagementRoleEntry "Widget Cmdlets\Set-WidgetConfiguration" -PSSnapinName Contoso.Admin.Cmdlets -Parameters Database, Size -Type Cmdlet -UnscopedTopLevel

<table>
<thead>
<tr class="header">
<th><img src="images/JJ126620.note(EXCHG.150).gif" title="Примечание" alt="Примечание" />Примечание.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Командлет <strong>Add-ManagementRoleEntry</strong> выполняет стандартную проверку, чтобы убедиться, что добавлены только те параметры, которые существуют в командлете. Но после добавления записи роли никакой дальнейшей проверки не следует. Если командлет изменен позже и, соответственно, параметры позже добавлены или удалены, необходимо вручную обновить записи роли, которые содержат командлет.</td>
</tr>
</tbody>
</table>


## Другие задачи

После добавления записи роли или роли верхнего уровня с незаданной областью можно выполнить другие действия.

[Добавьте запись роли в роли](add-a-role-entry-to-a-role-exchange-2013-help.md)

[Управление группами ролей](manage-role-groups-exchange-2013-help.md)

[Управление участниками группы ролей](manage-role-group-members-exchange-2013-help.md)

[Добавление роли для пользователя или универсальной группы безопасности](add-a-role-to-a-user-or-usg-exchange-2013-help.md)

[Удалить роль из пользователя или универсальной группы безопасности](remove-a-role-from-a-user-or-usg-exchange-2013-help.md)

